(function(){"use strict";var e={2223:function(e,a,t){var o=t(5130),r=t(6768),n=t(657),l=t(144),s=(t(4114),t(4373)),i=t(7694),c=t(1387),u=(t(4603),t(7566),t(8721),t(4232)),d=t(1576),p=t.n(d),g=t(4079),m=t(2076);const v=(0,r.pM)({name:"ReportTable"});var f=(0,r.pM)({...v,props:{tabKey:{},columns:{},dataSource:{},paginationConfig:{},paginationParams:{}},emits:["download"],setup(e,{emit:a}){const t=a,o=e,n=e=>{t("download",o.tabKey,e)};return(e,a)=>{const t=(0,r.g2)("a-button"),o=(0,r.g2)("a-table");return(0,r.uX)(),(0,r.Wv)(o,{columns:e.columns,"data-source":e.dataSource,bordered:"",pagination:e.paginationConfig,"row-key":e=>e.id},{bodyCell:(0,r.k6)((({column:o,record:s,index:i})=>["index"===o.key?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)((0,u.v_)((e.paginationParams.pageIndex-1)*e.paginationParams.pageSize+i+1),1)],64)):"createTime"===o.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,r.eW)((0,u.v_)((0,l.R1)(p())(s.createdtime).format("YYYY-MM-DD HH:mm:ss")),1)],64)):"action"===o.key?((0,r.uX)(),(0,r.Wv)(t,{key:2,onClick:e=>n(s.id)},{default:(0,r.k6)((()=>a[0]||(a[0]=[(0,r.eW)("下载")]))),_:2},1032,["onClick"])):(0,r.Q3)("",!0)])),_:1},8,["columns","data-source","pagination","row-key"])}}}),h=t(1241);const y=(0,h.A)(f,[["__scopeId","data-v-2a02e577"]]);var b=y,k=t(6011),w=t(8392);t(4514);const x={id:"userManagePage"},_={class:"batch-download-container"},F={class:"date-range-group"},A={class:"batch-tips"};var L=(0,r.pM)({__name:"HomePage",setup(e){p().locale("zh-cn");const a=[{key:"1",tab:"日报表"},{key:"2",tab:"周报表"},{key:"3",tab:"月报表"},{key:"4",tab:"年报表"}],t=[{title:"序号",key:"index",width:80,align:"center"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"操作",key:"action",width:120,align:"center"}],o=(0,l.KR)("1"),n=(0,l.KR)(!1),s=(0,l.Kh)({pageIndex:1,pageSize:10,total:0}),c=(0,l.Kh)({1:{list:[]},2:{list:[]},3:{list:[]},4:{list:[]}}),d=(0,l.KR)(""),v=(0,l.KR)(null),f=(0,l.KR)(null),h=(0,l.KR)(!1),y={3:"month"},L={3:"YYYY年MM月"},U=(0,r.EW)((()=>({current:s.pageIndex,pageSize:s.pageSize,total:s.total,pageSizeOptions:["10","20","50","100"],showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`,onChange:(e,t)=>{s.pageIndex=e,s.pageSize=t,a.map((e=>e.key)).includes(o.value)&&M(o.value)},onShowSizeChange:(e,t)=>{s.pageIndex=1,s.pageSize=t,a.map((e=>e.key)).includes(o.value)&&M(o.value)}}))),C=(0,r.EW)((()=>d.value&&y[d.value]||"date")),R=(0,r.EW)((()=>d.value&&L[d.value]||"YYYY年MM月DD日")),I=e=>e?.isAfter(p()().endOf("day"))||!1,P=()=>d.value?v.value&&f.value?!v.value.isAfter(f.value)||(i.Ay.warning("开始时间不能晚于结束时间"),!1):(i.Ay.warning("请选择开始时间和结束时间"),!1):(i.Ay.warning("请选择报表类型"),!1),S=(e,a,t)=>{const o={xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",zip:"application/zip"},r=new Blob([e.data],{type:o[t]}),n=e.headers?.["content-disposition"];let l=a;if(n){const e=n.match(/filename\*=UTF-8''([^;]+)/i);if(e?.[1])l=decodeURIComponent(e[1]);else{const e=n.match(/filename=([^;]+)/i);e?.[1]&&(l=decodeURIComponent(e[1].replace(/['"]/g,"")))}}const s=window.URL.createObjectURL(r),c=document.createElement("a");c.href=s,c.download=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(s),i.Ay.success(("xlsx"===t?"报表":"ZIP包")+"下载成功")},E=async(e,a)=>{if(!a)return i.Ay.warning("ID 不能为空");try{const t=await qe(Number(a),Number(e));S(t,"报表.xlsx","xlsx")}catch(t){console.error("报表下载失败：",t),i.Ay.error("下载失败：网络异常或接口错误")}},T=async()=>{if(!P())return;const e={type:Number(d.value),startTime:v.value.format(R.value),endTime:f.value.format(R.value)};try{h.value=!0;const a=await Xe(e);S(a,`批量报表_${p()().format("YYYYMMDDHHmmss")}.zip`,"zip")}catch(a){console.error("批量下载ZIP失败：",a),i.Ay.error("批量下载失败：网络异常或接口错误")}finally{h.value=!1}},K=e=>{o.value=e,"5"!==e&&(s.pageIndex=1,M(e))},W=()=>{v.value=null,f.value=null},O=()=>{d.value="",v.value=null,f.value=null},M=async e=>{if(!n.value)try{n.value=!0;const a=await ze({pageIndex:s.pageIndex,pageSize:s.pageSize,type:Number(e)});a.data?(c[e].list=a.data.data||[],s.total=a.data.totalCount||0):i.Ay.error(`获取${e}号表格数据失败`)}catch(a){console.error(`获取${e}号表格数据异常：`,a),i.Ay.error(`获取${e}号表格数据失败：网络异常`)}finally{n.value=!1}};return M("1"),(e,o)=>{const n=(0,r.g2)("a-tab-pane"),i=(0,r.g2)("a-select-option"),p=(0,r.g2)("a-select"),y=(0,r.g2)("a-form-item"),L=(0,r.g2)("a-date-picker"),P=(0,r.g2)("a-button"),S=(0,r.g2)("a-form"),M=(0,r.g2)("a-tabs");return(0,r.uX)(),(0,r.CE)("div",x,[(0,r.bF)(M,{"default-active-key":"1",type:"card",onChange:K},{default:(0,r.k6)((()=>[((0,r.uX)(),(0,r.CE)(r.FK,null,(0,r.pI)(a,(e=>(0,r.bF)(n,{key:e.key,tab:e.tab},{default:(0,r.k6)((()=>[(0,r.bF)(b,{"tab-key":e.key,columns:t,"data-source":c[e.key]?.list||[],"pagination-config":U.value,"pagination-params":s,onDownload:E},null,8,["tab-key","data-source","pagination-config","pagination-params"])])),_:2},1032,["tab"]))),64)),(0,r.bF)(n,{tab:"批量下载报表",key:"5"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",_,[o[6]||(o[6]=(0,r.Lk)("div",{class:"batch-download-header"},[(0,r.Lk)("h3",{class:"batch-download-title"},"批量报表下载"),(0,r.Lk)("p",{class:"batch-download-desc"}," 根据选择的报表类型和时间范围，批量下载报表文件并打包为ZIP格式 ")],-1)),(0,r.bF)((0,l.R1)(k.Ay),{locale:(0,l.R1)(w.A)},{default:(0,r.k6)((()=>[(0,r.bF)(S,{class:"batch-download-form",layout:"vertical","label-col":{span:4},"wrapper-col":{span:20}},{default:(0,r.k6)((()=>[(0,r.bF)(y,{label:"报表类型","validate-status":d.value?"":"error",help:d.value?"":"请选择报表类型"},{default:(0,r.k6)((()=>[(0,r.bF)(p,{value:d.value,"onUpdate:value":o[0]||(o[0]=e=>d.value=e),style:{width:"100%","max-width":"300px"},placeholder:"请选择报表类型","allow-clear":"",onChange:W},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.filter((e=>"4"!==e.key)),(e=>((0,r.uX)(),(0,r.Wv)(i,{key:e.key,value:e.key},{default:(0,r.k6)((()=>[(0,r.eW)((0,u.v_)(e.tab),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1},8,["validate-status","help"]),(0,r.Lk)("div",F,[(0,r.bF)(y,{label:"开始时间","validate-status":!v.value&&d.value?"error":"",help:!v.value&&d.value?"请选择开始时间":""},{default:(0,r.k6)((()=>[(0,r.bF)(L,{value:v.value,"onUpdate:value":o[1]||(o[1]=e=>v.value=e),picker:C.value,style:{width:"100%","max-width":"300px"},placeholder:"选择开始时间",format:R.value,"allow-clear":"","disabled-date":I},null,8,["value","picker","format"])])),_:1},8,["validate-status","help"]),(0,r.bF)(y,{label:"结束时间","validate-status":!f.value&&d.value?"error":"",help:!f.value&&d.value?"请选择结束时间":""},{default:(0,r.k6)((()=>[(0,r.bF)(L,{value:f.value,"onUpdate:value":o[2]||(o[2]=e=>f.value=e),picker:C.value,style:{width:"100%","max-width":"300px"},placeholder:"选择结束时间",format:R.value,"allow-clear":"","disabled-date":I},null,8,["value","picker","format"])])),_:1},8,["validate-status","help"])]),(0,r.bF)(y,{"wrapper-col":{offset:4}},{default:(0,r.k6)((()=>[(0,r.bF)(P,{type:"primary",onClick:T,loading:h.value,class:"batch-download-btn"},{icon:(0,r.k6)((()=>[(0,r.bF)((0,l.R1)(g.A))])),default:(0,r.k6)((()=>[o[3]||(o[3]=(0,r.eW)(" 批量下载ZIP "))])),_:1},8,["loading"]),(0,r.bF)(P,{onClick:O,style:{"margin-left":"12px"}},{default:(0,r.k6)((()=>o[4]||(o[4]=[(0,r.eW)(" 重置 ")]))),_:1}),(0,r.Lk)("div",A,[(0,r.bF)((0,l.R1)(m.A),{style:{"margin-right":"4px"}}),o[5]||(o[5]=(0,r.eW)(" 提示：下载的ZIP包包含所选时间范围内的所有对应类型报表文件 "))])])),_:1})])),_:1})])),_:1},8,["locale"])])])),_:1})])),_:1})])}}});const U=(0,h.A)(L,[["__scopeId","data-v-5887c7d2"]]);var C=U;const R={id:"userManagePage"},I={key:0},P={key:1},S={key:0},E={key:1},T={key:2};var K=(0,r.pM)({__name:"UserManagePage",setup(e){const a=(0,l.KR)(""),t=async()=>{c(a.value)},o=async e=>{if(!e)return;const a=await Me(e);0===a.data.code?(c(),i.Ay.success("删除成功")):i.Ay.error("删除失败")},n=[{title:"id",dataIndex:"id"},{title:"用户名",dataIndex:"userName"},{title:"账号",dataIndex:"userAccount"},{title:"头像",dataIndex:"avatarUrl"},{title:"性别",dataIndex:"gender"},{title:"创建时间",dataIndex:"createTime"},{title:"用户角色",dataIndex:"userRole"},{title:"操作",key:"action"}],s=(0,l.KR)([]),c=async(e="")=>{const a=await Oe(e);a.data.data?s.value=a.data.data:i.Ay.error("获取数据失败")};return c(),(e,i)=>{const c=(0,r.g2)("a-input-search"),d=(0,r.g2)("a-image"),g=(0,r.g2)("a-tag"),m=(0,r.g2)("a-button"),v=(0,r.g2)("a-table");return(0,r.uX)(),(0,r.CE)("div",R,[(0,r.bF)(c,{style:{"max-width":"320px","margin-bottom":"20px"},value:a.value,"onUpdate:value":i[0]||(i[0]=e=>a.value=e),placeholder:"输入用户名搜索","enter-button":"搜索",size:"large",onSearch:t},null,8,["value"]),(0,r.bF)(v,{columns:n,"data-source":s.value},{bodyCell:(0,r.k6)((({column:e,record:a})=>["avatarUrl"===e.dataIndex?((0,r.uX)(),(0,r.Wv)(d,{key:0,src:a.avatarUrl,width:120},null,8,["src"])):"userRole"===e.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[1===a.role?((0,r.uX)(),(0,r.CE)("div",I,[(0,r.bF)(g,{color:"green"},{default:(0,r.k6)((()=>i[1]||(i[1]=[(0,r.eW)("管理员")]))),_:1})])):((0,r.uX)(),(0,r.CE)("div",P,[(0,r.bF)(g,{color:"blue"},{default:(0,r.k6)((()=>i[2]||(i[2]=[(0,r.eW)("普通用户")]))),_:1})]))],64)):"gender"===e.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:2},[0===a.gender?((0,r.uX)(),(0,r.CE)("div",S,[(0,r.bF)(g,{color:"blue"},{default:(0,r.k6)((()=>i[3]||(i[3]=[(0,r.eW)("男")]))),_:1})])):1===a.gender?((0,r.uX)(),(0,r.CE)("div",E,[(0,r.bF)(g,{color:"green"},{default:(0,r.k6)((()=>i[4]||(i[4]=[(0,r.eW)("女")]))),_:1})])):((0,r.uX)(),(0,r.CE)("div",T,[(0,r.bF)(g,{color:"gray"},{default:(0,r.k6)((()=>i[5]||(i[5]=[(0,r.eW)("未知")]))),_:1})]))],64)):(0,r.Q3)("",!0),"createTime"===e.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:3},[(0,r.eW)((0,u.v_)((0,l.R1)(p())(a.createTime).format("YYYY-MM-DD HH:mm:ss")),1)],64)):"action"===e.key?((0,r.uX)(),(0,r.Wv)(m,{key:4,danger:"",onClick:e=>o(a.id)},{default:(0,r.k6)((()=>i[6]||(i[6]=[(0,r.eW)("删除")]))),_:2},1032,["onClick"])):(0,r.Q3)("",!0)])),_:1},8,["data-source"])])}}});const W=K;var O=W;const M={id:"userLoginPage"},z={class:"login-card"};var q=(0,r.pM)({__name:"UserLoginPage",setup(e){const a=(0,c.rd)(),t=Ye(),o=(0,l.Kh)({userAccount:"",userPassword:""}),n=async e=>{try{console.log("登录请求参数：",e);const o=await Te(e);console.log("登录接口返回：",o);const r=o.data||o;0===r.code&&r.data?(t.setLoginUser(r.data),i.Ay.success("登录成功"),setTimeout((async()=>{await a.push({path:"/app/home",replace:!0}),console.log("登录成功，跳转到首页")}),500)):i.Ay.error(r.message||"登录失败：账号或密码错误")}catch(o){i.Ay.error(o.message||"登录异常，请稍后重试"),console.error("登录请求失败：",o)}},s=e=>{console.log("表单验证失败：",e)};return(e,a)=>{const t=(0,r.g2)("a-input"),l=(0,r.g2)("a-form-item"),i=(0,r.g2)("a-input-password"),c=(0,r.g2)("a-button"),u=(0,r.g2)("a-form");return(0,r.uX)(),(0,r.CE)("div",M,[(0,r.Lk)("div",z,[a[3]||(a[3]=(0,r.Lk)("h2",{class:"title"},"用户登录",-1)),(0,r.bF)(u,{model:o,"label-align":"left",name:"basic","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",onFinish:n,onFinishFailed:s},{default:(0,r.k6)((()=>[(0,r.bF)(l,{label:"账号",name:"userAccount",rules:[{required:!0,message:"请输入账号！"}]},{default:(0,r.k6)((()=>[(0,r.bF)(t,{value:o.userAccount,"onUpdate:value":a[0]||(a[0]=e=>o.userAccount=e),placeholder:"请输入账号"},null,8,["value"])])),_:1}),(0,r.bF)(l,{label:"密码",name:"userPassword",rules:[{required:!0,message:"请输入密码!"},{min:8,message:"密码不能小于8位"}]},{default:(0,r.k6)((()=>[(0,r.bF)(i,{value:o.userPassword,"onUpdate:value":a[1]||(a[1]=e=>o.userPassword=e),placeholder:"请输入密码"},null,8,["value"])])),_:1}),(0,r.bF)(l,{"wrapper-col":{offset:4,span:20}},{default:(0,r.k6)((()=>[(0,r.bF)(c,{type:"primary","html-type":"submit",block:""},{default:(0,r.k6)((()=>a[2]||(a[2]=[(0,r.eW)("登录")]))),_:1})])),_:1})])),_:1},8,["model"])])])}}});const X=(0,h.A)(q,[["__scopeId","data-v-d06a875c"]]);var Y=X;const D={id:"userRegisterPage"};var j=(0,r.pM)({__name:"UserRegisterPage",setup(e){const a=(0,c.rd)(),t=Ye(),o=(0,l.Kh)({userAccount:"",userPassword:"",checkPassword:""}),n=async e=>{if(o.userPassword!==o.checkPassword)return void i.Ay.error("二次输入的密码不一致");const r=await Ee(e);0===r.data.code&&r.data.data?(await t.fetchLoginUser(),i.Ay.success("注册成功"),a.push({path:"/user/login",replace:!0})):i.Ay.error("注册失败"+r.data.description)},s=e=>{console.log("Failed:",e)};return(e,a)=>{const t=(0,r.g2)("a-input"),l=(0,r.g2)("a-form-item"),i=(0,r.g2)("a-input-password"),c=(0,r.g2)("a-button"),u=(0,r.g2)("a-form");return(0,r.uX)(),(0,r.CE)("div",D,[a[4]||(a[4]=(0,r.Lk)("h2",{class:"title"},"用户注册",-1)),(0,r.bF)(u,{style:{"max-width":"480px",margin:"0 auto"},model:o,"label-align":"left",name:"basic","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",onFinish:n,onFinishFailed:s},{default:(0,r.k6)((()=>[(0,r.bF)(l,{label:"账号",name:"userAccount",rules:[{required:!0,message:"请输入账号！"}]},{default:(0,r.k6)((()=>[(0,r.bF)(t,{value:o.userAccount,"onUpdate:value":a[0]||(a[0]=e=>o.userAccount=e)},null,8,["value"])])),_:1}),(0,r.bF)(l,{label:"密码",name:"userPassword",rules:[{required:!0,message:"请输入密码!"},{min:8,message:"密码不能小于8位"}]},{default:(0,r.k6)((()=>[(0,r.bF)(i,{value:o.userPassword,"onUpdate:value":a[1]||(a[1]=e=>o.userPassword=e),placeholder:"请输入密码"},null,8,["value"])])),_:1}),(0,r.bF)(l,{label:"确认密码",name:"checkPassword",rules:[{required:!0,message:"请输入确认密码!"},{min:8,message:"确认密码不能小于8位"}]},{default:(0,r.k6)((()=>[(0,r.bF)(i,{value:o.checkPassword,"onUpdate:value":a[2]||(a[2]=e=>o.checkPassword=e),placeholder:"请输入确认密码"},null,8,["value"])])),_:1}),(0,r.bF)(l,{"wrapper-col":{offset:4,span:20}},{default:(0,r.k6)((()=>[(0,r.bF)(c,{type:"primary","html-type":"submit"},{default:(0,r.k6)((()=>a[3]||(a[3]=[(0,r.eW)("注册")]))),_:1})])),_:1})])),_:1},8,["model"])])}}});const N=j;var $=N,B=t.p+"img/hb.7bbb4a0e.jpg",H=t(1043);const G={class:"layout-container"},J={class:"sidebar"},Z={class:"logout-btn"},Q={class:"main-content"};var V=(0,r.pM)({__name:"BasicLayout",setup(e){const a=(0,c.rd)(),t=Ye(),o=(0,l.KR)([{key:"/app/home",label:"主页",title:"主页",icon:()=>(0,r.h)(H.A)},{key:"/app/components/leader-dashboard",label:"领导仓数据看板",title:"领导仓数据看板"}]),n=({key:e})=>{a.push(e)},s=(0,l.KR)(["/app/home"]);a.afterEach((e=>{s.value=[e.path]}));const u=async()=>{try{await Ke({}),"function"===typeof t.clearLoginUser?t.clearLoginUser():t.loginUser={userName:"未登录"},localStorage.removeItem("loginUser"),localStorage.removeItem("token"),d(),i.Ay.success("退出成功"),a.replace({path:"/user/login"})}catch(e){console.error("退出登录接口调用失败：",e),"function"===typeof t.clearLoginUser?t.clearLoginUser():t.loginUser={userName:"未登录"},localStorage.removeItem("loginUser"),localStorage.removeItem("token"),d(),i.Ay.success("已退出登录"),a.replace({path:"/user/login"})}},d=()=>{const e=document.cookie.split(";");for(let a=0;a<e.length;a++){const t=e[a],o=t.indexOf("="),r=o>-1?t.substr(0,o).trim():t.trim();document.cookie=`${r}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/; domain=${window.location.hostname}`}};return(e,a)=>{const t=(0,r.g2)("a-menu"),l=(0,r.g2)("a-button"),i=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",G,[(0,r.Lk)("aside",J,[a[2]||(a[2]=(0,r.Lk)("div",{class:"sidebar-header"},[(0,r.Lk)("img",{class:"logo",src:B,alt:"logo"})],-1)),(0,r.bF)(t,{selectedKeys:s.value,"onUpdate:selectedKeys":a[0]||(a[0]=e=>s.value=e),mode:"vertical",items:o.value,onClick:n,class:"sidebar-menu"},null,8,["selectedKeys","items"]),(0,r.Lk)("div",Z,[(0,r.bF)(l,{type:"text",onClick:u},{default:(0,r.k6)((()=>a[1]||(a[1]=[(0,r.eW)("退出登录")]))),_:1})])]),(0,r.Lk)("main",Q,[(0,r.bF)(i)])])}}});const ee=(0,h.A)(V,[["__scopeId","data-v-1515a970"]]);var ae=ee,te=(t(1454),t(2805)),oe=t(2212),re=t(2305),ne=t(9839),le=t(2297),se=t(9119),ie=t(623),ce=t(9536),ue=t(5143),de=t(8304),pe=t(7917),ge=t(1611),me=t(753),ve=t(8915),fe=t(2080),he=t(5095);oe.Y([ie.a,ce.a,ue.a,de.a,pe.a,ge.a,me.a,ne.a,le.a,se.a,ve._,fe.i,he.a]);var ye=re;const be={id:"leaderDashboardPage"},ke={class:"production-cards"},we={class:"chart-section pie-chart-section"},xe={class:"chart-section line-charts-section"},_e={class:"refresh-btn-group"};var Fe=(0,r.pM)({__name:"LeaderDashboard",setup(e){const a=(0,l.KR)(!1),t=(0,l.Kh)({yesterday:0,week:0,month:0,year:0}),o=(0,l.KR)(null),n=(0,l.KR)(null),s=(0,l.KR)(null),c=(0,l.KR)(null);let u=null,d=null,p=null,g=null;const m=(0,l.KR)([]),v=(0,l.KR)({xAxis:[],series:[]}),f=(0,l.KR)({xAxis:[],series:[]}),h=(0,l.KR)({xAxis:[],series:[]}),y=async e=>new Promise((e=>{setTimeout((()=>{e({yesterday:12580,week:89650,month:385600,year:4258900})}),800)})),b=async e=>new Promise((e=>{setTimeout((()=>{e([{name:"车间A",value:185e3},{name:"车间B",value:126e3},{name:"车间C",value:74600},{name:"外协加工",value:45800}])}),800)})),k=async e=>new Promise((e=>{setTimeout((()=>{e({xAxis:["01日","02日","03日","04日","05日","06日","07日"],series:[{name:"日产量",data:[11800,12580,13200,11950,12800,12100,12580]}]})}),800)})),w=async e=>new Promise((e=>{setTimeout((()=>{e({xAxis:["第1周","第2周","第3周","第4周","第5周"],series:[{name:"周产量",data:[78500,82600,85800,89650,87200]}]})}),800)})),x=async e=>new Promise((e=>{setTimeout((()=>{e({xAxis:["1月","2月","3月","4月","5月","6月"],series:[{name:"月产量",data:[325e3,348e3,362e3,375e3,38e4,385600]}]})}),800)})),_=()=>{if(!o.value)return;u&&u.dispose(),u=ye.init(o.value);const e={color:["#003399","#00AEEF","#0066CC","#66B2FF"],tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} 件 ({d}%)"},legend:{orient:"horizontal",bottom:0,textStyle:{color:"#333"}},series:[{name:"产量占比",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:16,fontWeight:600}},labelLine:{show:!1},data:m.value}]};u.setOption(e)},F=(e,a,t,o)=>{if(!e)return null;a&&a.dispose();const r=ye.init(e),n={color:["#003399"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:t.xAxis,axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"}},yAxis:{type:"value",name:o,nameTextStyle:{color:"#003399"},axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"},splitLine:{lineStyle:{color:"#e8f4fc"}}},series:t.series.map((e=>({name:e.name,type:"line",smooth:!0,data:e.data,lineStyle:{width:2},itemStyle:{color:"#00AEEF",borderColor:"#003399",borderWidth:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(0, 174, 239, 0.2)"},{offset:1,color:"rgba(0, 174, 239, 0.05)"}]}}})))};return r.setOption(n),r},A=()=>{_(),d=F(n.value,d,v.value,"产量(件)"),p=F(s.value,p,f.value,"产量(件)"),g=F(c.value,g,h.value,"产量(件)")},L=()=>{u?.resize(),d?.resize(),p?.resize(),g?.resize()},U=async()=>{try{a.value=!0;const e={},[o,r,n,l,s]=await Promise.all([y(e),b(e),k(e),w(e),x(e)]);Object.assign(t,o),m.value=r,v.value=n,f.value=l,h.value=s,A(),i.Ay.success("全部数据刷新成功")}catch(e){console.error("获取数据失败：",e),i.Ay.error("数据加载失败，请稍后重试")}finally{a.value=!1}};return(0,r.sV)((async()=>{await U(),window.addEventListener("resize",L)})),(0,r.hi)((()=>{u?.dispose(),d?.dispose(),p?.dispose(),g?.dispose(),window.removeEventListener("resize",L)})),(0,r.wB)([m,v,f,h],(()=>{A()}),{deep:!0}),(e,i)=>{const u=(0,r.g2)("a-statistic"),d=(0,r.g2)("a-card"),p=(0,r.g2)("a-button");return(0,r.uX)(),(0,r.CE)("div",be,[i[1]||(i[1]=(0,r.Lk)("div",{class:"page-header"},[(0,r.Lk)("h2",{class:"page-title"},"领导仓数据看板"),(0,r.Lk)("p",{class:"page-desc"},"实时展示产量核心指标及趋势数据")],-1)),(0,r.Lk)("div",ke,[(0,r.bF)(d,{class:"production-card",loading:a.value,hoverable:""},{default:(0,r.k6)((()=>[(0,r.bF)(u,{title:"昨日产量",value:t.yesterday,precision:0,suffix:"件",class:"stat-item"},{prefix:(0,r.k6)((()=>[(0,r.bF)((0,l.R1)(te.A),{class:"stat-icon"})])),_:1},8,["value"])])),_:1},8,["loading"]),(0,r.bF)(d,{class:"production-card",loading:a.value,hoverable:""},{default:(0,r.k6)((()=>[(0,r.bF)(u,{title:"当周产量",value:t.week,precision:0,suffix:"件",class:"stat-item"},{prefix:(0,r.k6)((()=>[(0,r.bF)((0,l.R1)(te.A),{class:"stat-icon"})])),_:1},8,["value"])])),_:1},8,["loading"]),(0,r.bF)(d,{class:"production-card",loading:a.value,hoverable:""},{default:(0,r.k6)((()=>[(0,r.bF)(u,{title:"当月产量",value:t.month,precision:0,suffix:"件",class:"stat-item"},{prefix:(0,r.k6)((()=>[(0,r.bF)((0,l.R1)(te.A),{class:"stat-icon"})])),_:1},8,["value"])])),_:1},8,["loading"]),(0,r.bF)(d,{class:"production-card",loading:a.value,hoverable:""},{default:(0,r.k6)((()=>[(0,r.bF)(u,{title:"今年产量",value:t.year,precision:0,suffix:"件",class:"stat-item"},{prefix:(0,r.k6)((()=>[(0,r.bF)((0,l.R1)(te.A),{class:"stat-icon"})])),_:1},8,["value"])])),_:1},8,["loading"])]),(0,r.Lk)("div",we,[(0,r.bF)(d,{class:"chart-card",loading:a.value,title:"产量占比分析","title-style":{color:"#003399",fontWeight:600}},{default:(0,r.k6)((()=>[(0,r.Lk)("div",{ref_key:"pieChartRef",ref:o,class:"chart-container"},null,512)])),_:1},8,["loading"])]),(0,r.Lk)("div",xe,[(0,r.bF)(d,{class:"chart-card line-chart-card",loading:a.value,title:"日产量趋势","title-style":{color:"#003399",fontWeight:600}},{default:(0,r.k6)((()=>[(0,r.Lk)("div",{ref_key:"dayLineChartRef",ref:n,class:"chart-container"},null,512)])),_:1},8,["loading"]),(0,r.bF)(d,{class:"chart-card line-chart-card",loading:a.value,title:"周产量趋势","title-style":{color:"#003399",fontWeight:600}},{default:(0,r.k6)((()=>[(0,r.Lk)("div",{ref_key:"weekLineChartRef",ref:s,class:"chart-container"},null,512)])),_:1},8,["loading"]),(0,r.bF)(d,{class:"chart-card line-chart-card",loading:a.value,title:"月产量趋势","title-style":{color:"#003399",fontWeight:600}},{default:(0,r.k6)((()=>[(0,r.Lk)("div",{ref_key:"monthLineChartRef",ref:c,class:"chart-container"},null,512)])),_:1},8,["loading"])]),(0,r.Lk)("div",_e,[(0,r.bF)(p,{type:"primary",onClick:U,loading:a.value,icon:"reload"},{default:(0,r.k6)((()=>i[0]||(i[0]=[(0,r.eW)(" 刷新全部数据 ")]))),_:1},8,["loading"])])])}}});const Ae=(0,h.A)(Fe,[["__scopeId","data-v-ab4a0758"]]);var Le=Ae;const Ue=[{path:"/",redirect:"/user/login"},{path:"/user/login",name:"userLogin",component:Y,meta:{requiresAuth:!1}},{path:"/user/register",name:"userRegister",component:$,meta:{requiresAuth:!1}},{path:"/app",component:ae,meta:{requiresAuth:!0},children:[{path:"home",name:"homePage",component:C},{path:"admin/userManage",name:"adminUserManage",component:O},{path:"components/leader-dashboard",name:"LeaderDashboard",component:Le,meta:{title:"领导仓数据看板"}}]},{path:"/:pathMatch(.*)*",redirect:"/user/login"}],Ce=(0,c.aE)({history:(0,c.LA)("/"),routes:Ue});Ce.beforeEach(((e,a,t)=>{const o=Ye(),r=localStorage.getItem("loginUser");if(r)try{const e=JSON.parse(r);e.id&&!o.loginUser.id&&o.setLoginUser(e)}catch(l){console.error("本地存储用户信息异常：",l),localStorage.removeItem("loginUser"),o.setLoginUser({id:""})}const n=!!o.loginUser.id;e.meta.requiresAuth?n?t():(i.Ay.warning("请先登录后再访问"),t({path:"/user/login",query:{redirect:encodeURIComponent(e.fullPath)}})):!n||"/user/login"!==e.path&&"/user/register"!==e.path?t():t("/app/home")}));var Re=Ce;let Ie=!1;const Pe=s.A.create({baseURL:"http://192.168.2.250:5260",timeout:1e4,withCredentials:!0});Pe.interceptors.request.use((function(e){return e.headers["Content-Type"]||(e.headers["Content-Type"]="application/json;charset=UTF-8"),e}),(function(e){return i.Ay.error("请求配置异常，请检查参数或网络设置"),console.error("请求拦截器错误：",e),Promise.reject(e)})),Pe.interceptors.response.use((function(e){if("blob"===e.config.responseType){let a="导出文件.xlsx";if(e.headers["content-disposition"]||e.headers["Content-Disposition"])try{const t=e.headers["content-disposition"]||e.headers["Content-Disposition"];a=decodeURI(t.split("filename=")[1]),a=a.replace(/"/g,"")}catch(t){a="导出文件.xlsx"}return e.fileBlobData=e.data,e.fileDownloadName=a,e}const{data:a}=e;if(console.log("响应数据：",a),40100===a.code){const a=e.request.responseURL.includes("user/current"),t=Re.currentRoute.value.path.includes("/user/login");if(!a&&!t&&!Ie){Ie=!0,i.Ay.warning("登录状态已过期，请重新登录");const e=Ye();e.setLoginUser({id:""}),localStorage.removeItem("loginUser"),Re.push({path:"/user/login",query:{redirect:encodeURIComponent(Re.currentRoute.value.fullPath)}}).finally((()=>{Ie=!1}))}}return a.code&&0!==a.code&&40100!==a.code&&i.Ay.error(a.message||`请求失败（错误码：${a.code}）`),e}),(function(e){if(e.response){const a=e.response.status;if(401!==a||Ie)401!==a&&i.Ay.error(`请求失败（HTTP状态码：${a}）`);else{const e=Re.currentRoute.value.path.includes("/user/login");if(!e){Ie=!0,i.Ay.warning("登录状态已过期，请重新登录");const e=Ye();e.setLoginUser({id:""}),localStorage.removeItem("loginUser"),Re.push({path:"/user/login",query:{redirect:encodeURIComponent(Re.currentRoute.value.fullPath)}}).finally((()=>{Ie=!1}))}}}else e.request?i.Ay.error("网络异常，请检查网络连接"):i.Ay.error("请求配置失败："+e.message);return console.error("响应拦截器错误：",e),Promise.reject(e)}));var Se=Pe;const Ee=async e=>Se.request({url:"api/user/register",method:"POST",data:e}),Te=async e=>Se.request({url:"api/user/login",method:"POST",data:e}),Ke=async e=>Se.request({url:"api/user/logout",method:"POST",data:e}),We=async()=>Se.request({url:"api/user/current",method:"GET"}),Oe=async e=>Se.request({url:"api/user/search",method:"GET",params:{userName:e}}),Me=async e=>Se.request({url:"api/user/delete",method:"POST",data:e,headers:{"Content-Type":"application/json"}}),ze=async e=>Se.request({url:"/api/ReportRecord/GetReportByPage",method:"GET",params:e}),qe=async(e,a)=>Se.request({url:"api/Report/ExportExcel",method:"GET",params:{id:e,tabKey:a},responseType:"blob",timeout:6e4}),Xe=async e=>Se.request({url:"api/Report/BatchExportZip",method:"GET",params:e,responseType:"blob",timeout:12e4}),Ye=(0,n.nY)("loginUser",(()=>{const e=(0,l.KR)(localStorage.getItem("loginUser")?JSON.parse(localStorage.getItem("loginUser")):{userName:"未登录"});async function a(){try{const a=await We();0===a.data.code&&a.data.data&&(console.log("接口获取用户信息：",a.data.data),e.value=a.data.data,localStorage.setItem("loginUser",JSON.stringify(a.data.data)),a.data.data.token&&localStorage.setItem("token",a.data.data.token))}catch(a){console.error("获取当前用户信息失败：",a)}}function t(a){e.value=a,localStorage.setItem("loginUser",JSON.stringify(a)),a.token&&localStorage.setItem("token",a.token)}function o(){e.value={userName:"未登录"},localStorage.removeItem("loginUser"),localStorage.removeItem("token")}function r(){const a=localStorage.getItem("loginUser");a&&(e.value=JSON.parse(a))}return{loginUser:e,setLoginUser:t,fetchLoginUser:a,clearLoginUser:o,restoreLoginUser:r}})),De={id:"app"};var je=(0,r.pM)({__name:"App",setup(e){const a=Ye();return a.fetchLoginUser(),(e,a)=>{const t=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",De,[(0,r.bF)(t)])}}});const Ne=je;var $e=Ne,Be=t(5296);t(4529);const He=(0,o.Ef)($e);He.use((0,n.Ey)()),He.use(Re),He.use(Be.Ay),window.addEventListener("unhandledrejection",(e=>{e.preventDefault();const a=e.reason;401!==a?.response?.status&&40100!==a?.response?.data?.code?(i.Ay.error("系统异常，请稍后重试"),console.error("全局捕获未处理的Promise错误：",a)):console.info("401错误已在axios拦截器中处理，无需重复提示",a)})),He.use(Be.Ay),He.config.globalProperties.$message=i.Ay;const Ge=Ye();Ge.restoreLoginUser(),He.mount("#app")}},a={};function t(o){var r=a[o];if(void 0!==r)return r.exports;var n=a[o]={exports:{}};return e[o].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(a,o,r,n){if(!o){var l=1/0;for(u=0;u<e.length;u++){o=e[u][0],r=e[u][1],n=e[u][2];for(var s=!0,i=0;i<o.length;i++)(!1&n||l>=n)&&Object.keys(t.O).every((function(e){return t.O[e](o[i])}))?o.splice(i--,1):(s=!1,n<l&&(l=n));if(s){e.splice(u--,1);var c=r();void 0!==c&&(a=c)}}return a}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[o,r,n]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var o in a)t.o(a,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:a[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){t.p="/"}(),function(){var e={524:0};t.O.j=function(a){return 0===e[a]};var a=function(a,o){var r,n,l=o[0],s=o[1],i=o[2],c=0;if(l.some((function(a){return 0!==e[a]}))){for(r in s)t.o(s,r)&&(t.m[r]=s[r]);if(i)var u=i(t)}for(a&&a(o);c<l.length;c++)n=l[c],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(u)},o=self["webpackChunkuser_center_frontend_vue"]=self["webpackChunkuser_center_frontend_vue"]||[];o.forEach(a.bind(null,0)),o.push=a.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(2223)}));o=t.O(o)})();
//# sourceMappingURL=app.1b00c4db.js.map