(function(){"use strict";var e={4015:function(e,a,t){var o=t(5130),r=t(6768),l=t(657),n=t(144),s=(t(4114),t(4373)),i=t(7694),c=t(1387),u=(t(4603),t(7566),t(8721),t(4232)),d=t(1576),p=t.n(d),g=t(4079),m=t(2076);const v=(0,r.pM)({name:"ReportTable"});var h=(0,r.pM)({...v,props:{tabKey:{},columns:{},dataSource:{},paginationConfig:{},paginationParams:{}},emits:["download"],setup(e,{emit:a}){const t=a,o=e,l=e=>{t("download",o.tabKey,e)};return(e,a)=>{const t=(0,r.g2)("a-button"),o=(0,r.g2)("a-table");return(0,r.uX)(),(0,r.Wv)(o,{columns:e.columns,"data-source":e.dataSource,bordered:"",pagination:e.paginationConfig,"row-key":e=>e.id},{bodyCell:(0,r.k6)((({column:o,record:s,index:i})=>["index"===o.key?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)((0,u.v_)((e.paginationParams.pageIndex-1)*e.paginationParams.pageSize+i+1),1)],64)):"createTime"===o.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,r.eW)((0,u.v_)((0,n.R1)(p())(s.createdtime).format("YYYY-MM-DD HH:mm:ss")),1)],64)):"action"===o.key?((0,r.uX)(),(0,r.Wv)(t,{key:2,onClick:e=>l(s.id)},{default:(0,r.k6)((()=>a[0]||(a[0]=[(0,r.eW)("下载")]))),_:2},1032,["onClick"])):(0,r.Q3)("",!0)])),_:1},8,["columns","data-source","pagination","row-key"])}}}),f=t(1241);const y=(0,f.A)(h,[["__scopeId","data-v-2a02e577"]]);var b=y,k=t(6011),w=t(8392);t(4514);const x={id:"userManagePage"},L={class:"batch-download-container"},_={class:"date-range-group"},A={class:"batch-tips"};var F=(0,r.pM)({__name:"HomePage",setup(e){p().locale("zh-cn");const a=[{key:"1",tab:"日报表"},{key:"2",tab:"周报表"},{key:"3",tab:"月报表"},{key:"4",tab:"年报表"}],t=[{title:"序号",key:"index",width:80,align:"center"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"操作",key:"action",width:120,align:"center"}],o=(0,n.KR)("1"),l=(0,n.KR)(!1),s=(0,n.Kh)({pageIndex:1,pageSize:10,total:0}),c=(0,n.Kh)({1:{list:[]},2:{list:[]},3:{list:[]},4:{list:[]}}),d=(0,n.KR)(""),v=(0,n.KR)(null),h=(0,n.KR)(null),f=(0,n.KR)(!1),y={3:"month"},F={3:"YYYY年MM月"},S=(0,r.EW)((()=>({current:s.pageIndex,pageSize:s.pageSize,total:s.total,pageSizeOptions:["10","20","50","100"],showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`,onChange:(e,t)=>{s.pageIndex=e,s.pageSize=t,a.map((e=>e.key)).includes(o.value)&&W(o.value)},onShowSizeChange:(e,t)=>{s.pageIndex=1,s.pageSize=t,a.map((e=>e.key)).includes(o.value)&&W(o.value)}}))),U=(0,r.EW)((()=>d.value&&y[d.value]||"date")),C=(0,r.EW)((()=>d.value&&F[d.value]||"YYYY-MM-DD")),R=e=>e?.isAfter(p()().endOf("day"))||!1,I=()=>d.value?v.value&&h.value?!v.value.isAfter(h.value)||(i.Ay.warning("开始时间不能晚于结束时间"),!1):(i.Ay.warning("请选择开始时间和结束时间"),!1):(i.Ay.warning("请选择报表类型"),!1),P=(e,a,t)=>{const o={xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",zip:"application/zip"},r=new Blob([e.data],{type:o[t]}),l=e.headers?.["content-disposition"];let n=a;if(l){const e=l.match(/filename\*=UTF-8''([^;]+)/i);if(e?.[1])n=decodeURIComponent(e[1]);else{const e=l.match(/filename=([^;]+)/i);e?.[1]&&(n=decodeURIComponent(e[1].replace(/['"]/g,"")))}}const s=window.URL.createObjectURL(r),c=document.createElement("a");c.href=s,c.download=n,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(s),i.Ay.success(("xlsx"===t?"报表":"ZIP包")+"下载成功")},E=async(e,a)=>{if(!a)return i.Ay.warning("ID 不能为空");try{const t=await Re(Number(a),Number(e));P(t,"报表.xlsx","xlsx")}catch(t){console.error("报表下载失败：",t),i.Ay.error("下载失败：网络异常或接口错误")}},M=async()=>{if(!I())return;const e={type:Number(d.value),startTime:v.value.format(C.value),endTime:h.value.format(C.value)};try{f.value=!0;const a=await Ie(e);P(a,`批量报表_${p()().format("YYYYMMDDHHmmss")}.zip`,"zip")}catch(a){console.error("批量下载ZIP失败：",a),i.Ay.error("批量下载失败：网络异常或接口错误")}finally{f.value=!1}},T=e=>{o.value=e,"5"!==e&&(s.pageIndex=1,W(e))},K=()=>{v.value=null,h.value=null},O=()=>{d.value="",v.value=null,h.value=null},W=async e=>{if(!l.value)try{l.value=!0;const a=await Ce({pageIndex:s.pageIndex,pageSize:s.pageSize,type:Number(e)});a.data?(c[e].list=a.data.data||[],s.total=a.data.totalCount||0):i.Ay.error(`获取${e}号表格数据失败`)}catch(a){console.error(`获取${e}号表格数据异常：`,a),i.Ay.error(`获取${e}号表格数据失败：网络异常`)}finally{l.value=!1}};return W("1"),(e,o)=>{const l=(0,r.g2)("a-tab-pane"),i=(0,r.g2)("a-select-option"),p=(0,r.g2)("a-select"),y=(0,r.g2)("a-form-item"),F=(0,r.g2)("a-date-picker"),I=(0,r.g2)("a-button"),P=(0,r.g2)("a-form"),W=(0,r.g2)("a-tabs");return(0,r.uX)(),(0,r.CE)("div",x,[(0,r.bF)(W,{"default-active-key":"1",type:"card",onChange:T},{default:(0,r.k6)((()=>[((0,r.uX)(),(0,r.CE)(r.FK,null,(0,r.pI)(a,(e=>(0,r.bF)(l,{key:e.key,tab:e.tab},{default:(0,r.k6)((()=>[(0,r.bF)(b,{"tab-key":e.key,columns:t,"data-source":c[e.key]?.list||[],"pagination-config":S.value,"pagination-params":s,onDownload:E},null,8,["tab-key","data-source","pagination-config","pagination-params"])])),_:2},1032,["tab"]))),64)),(0,r.bF)(l,{tab:"批量下载报表",key:"5"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",L,[o[6]||(o[6]=(0,r.Lk)("div",{class:"batch-download-header"},[(0,r.Lk)("h3",{class:"batch-download-title"},"批量报表下载"),(0,r.Lk)("p",{class:"batch-download-desc"}," 根据选择的报表类型和时间范围，批量下载报表文件并打包为ZIP格式 ")],-1)),(0,r.bF)((0,n.R1)(k.Ay),{locale:(0,n.R1)(w.A)},{default:(0,r.k6)((()=>[(0,r.bF)(P,{class:"batch-download-form",layout:"vertical","label-col":{span:4},"wrapper-col":{span:20}},{default:(0,r.k6)((()=>[(0,r.bF)(y,{label:"报表类型","validate-status":d.value?"":"error",help:d.value?"":"请选择报表类型"},{default:(0,r.k6)((()=>[(0,r.bF)(p,{value:d.value,"onUpdate:value":o[0]||(o[0]=e=>d.value=e),style:{width:"100%","max-width":"300px"},placeholder:"请选择报表类型","allow-clear":"",onChange:K},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.filter((e=>"4"!==e.key)),(e=>((0,r.uX)(),(0,r.Wv)(i,{key:e.key,value:e.key},{default:(0,r.k6)((()=>[(0,r.eW)((0,u.v_)(e.tab),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1},8,["validate-status","help"]),(0,r.Lk)("div",_,[(0,r.bF)(y,{label:"开始时间","validate-status":!v.value&&d.value?"error":"",help:!v.value&&d.value?"请选择开始时间":""},{default:(0,r.k6)((()=>[(0,r.bF)(F,{value:v.value,"onUpdate:value":o[1]||(o[1]=e=>v.value=e),picker:U.value,style:{width:"100%","max-width":"300px"},placeholder:"选择开始时间",format:C.value,"allow-clear":"","disabled-date":R},null,8,["value","picker","format"])])),_:1},8,["validate-status","help"]),(0,r.bF)(y,{label:"结束时间","validate-status":!h.value&&d.value?"error":"",help:!h.value&&d.value?"请选择结束时间":""},{default:(0,r.k6)((()=>[(0,r.bF)(F,{value:h.value,"onUpdate:value":o[2]||(o[2]=e=>h.value=e),picker:U.value,style:{width:"100%","max-width":"300px"},placeholder:"选择结束时间",format:C.value,"allow-clear":"","disabled-date":R},null,8,["value","picker","format"])])),_:1},8,["validate-status","help"])]),(0,r.bF)(y,{"wrapper-col":{offset:4}},{default:(0,r.k6)((()=>[(0,r.bF)(I,{type:"primary",onClick:M,loading:f.value,class:"batch-download-btn"},{icon:(0,r.k6)((()=>[(0,r.bF)((0,n.R1)(g.A))])),default:(0,r.k6)((()=>[o[3]||(o[3]=(0,r.eW)(" 批量下载ZIP "))])),_:1},8,["loading"]),(0,r.bF)(I,{onClick:O,style:{"margin-left":"12px"}},{default:(0,r.k6)((()=>o[4]||(o[4]=[(0,r.eW)(" 重置 ")]))),_:1}),(0,r.Lk)("div",A,[(0,r.bF)((0,n.R1)(m.A),{style:{"margin-right":"4px"}}),o[5]||(o[5]=(0,r.eW)(" 提示：下载的ZIP包包含所选时间范围内的所有对应类型报表文件 "))])])),_:1})])),_:1})])),_:1},8,["locale"])])])),_:1})])),_:1})])}}});const S=(0,f.A)(F,[["__scopeId","data-v-64b9e371"]]);var U=S;const C={id:"userManagePage"},R={key:0},I={key:1},P={key:0},E={key:1},M={key:2};var T=(0,r.pM)({__name:"UserManagePage",setup(e){const a=(0,n.KR)(""),t=async()=>{c(a.value)},o=async e=>{if(!e)return;const a=await Ue(e);0===a.data.code?(c(),i.Ay.success("删除成功")):i.Ay.error("删除失败")},l=[{title:"id",dataIndex:"id"},{title:"用户名",dataIndex:"userName"},{title:"账号",dataIndex:"userAccount"},{title:"头像",dataIndex:"avatarUrl"},{title:"性别",dataIndex:"gender"},{title:"创建时间",dataIndex:"createTime"},{title:"用户角色",dataIndex:"userRole"},{title:"操作",key:"action"}],s=(0,n.KR)([]),c=async(e="")=>{const a=await Se(e);a.data.data?s.value=a.data.data:i.Ay.error("获取数据失败")};return c(),(e,i)=>{const c=(0,r.g2)("a-input-search"),d=(0,r.g2)("a-image"),g=(0,r.g2)("a-tag"),m=(0,r.g2)("a-button"),v=(0,r.g2)("a-table");return(0,r.uX)(),(0,r.CE)("div",C,[(0,r.bF)(c,{style:{"max-width":"320px","margin-bottom":"20px"},value:a.value,"onUpdate:value":i[0]||(i[0]=e=>a.value=e),placeholder:"输入用户名搜索","enter-button":"搜索",size:"large",onSearch:t},null,8,["value"]),(0,r.bF)(v,{columns:l,"data-source":s.value},{bodyCell:(0,r.k6)((({column:e,record:a})=>["avatarUrl"===e.dataIndex?((0,r.uX)(),(0,r.Wv)(d,{key:0,src:a.avatarUrl,width:120},null,8,["src"])):"userRole"===e.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[1===a.role?((0,r.uX)(),(0,r.CE)("div",R,[(0,r.bF)(g,{color:"green"},{default:(0,r.k6)((()=>i[1]||(i[1]=[(0,r.eW)("管理员")]))),_:1})])):((0,r.uX)(),(0,r.CE)("div",I,[(0,r.bF)(g,{color:"blue"},{default:(0,r.k6)((()=>i[2]||(i[2]=[(0,r.eW)("普通用户")]))),_:1})]))],64)):"gender"===e.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:2},[0===a.gender?((0,r.uX)(),(0,r.CE)("div",P,[(0,r.bF)(g,{color:"blue"},{default:(0,r.k6)((()=>i[3]||(i[3]=[(0,r.eW)("男")]))),_:1})])):1===a.gender?((0,r.uX)(),(0,r.CE)("div",E,[(0,r.bF)(g,{color:"green"},{default:(0,r.k6)((()=>i[4]||(i[4]=[(0,r.eW)("女")]))),_:1})])):((0,r.uX)(),(0,r.CE)("div",M,[(0,r.bF)(g,{color:"gray"},{default:(0,r.k6)((()=>i[5]||(i[5]=[(0,r.eW)("未知")]))),_:1})]))],64)):(0,r.Q3)("",!0),"createTime"===e.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:3},[(0,r.eW)((0,u.v_)((0,n.R1)(p())(a.createTime).format("YYYY-MM-DD HH:mm:ss")),1)],64)):"action"===e.key?((0,r.uX)(),(0,r.Wv)(m,{key:4,danger:"",onClick:e=>o(a.id)},{default:(0,r.k6)((()=>i[6]||(i[6]=[(0,r.eW)("删除")]))),_:2},1032,["onClick"])):(0,r.Q3)("",!0)])),_:1},8,["data-source"])])}}});const K=T;var O=K;const W={id:"userLoginPage"},z={class:"login-card"};var q=(0,r.pM)({__name:"UserLoginPage",setup(e){const a=(0,c.rd)(),t=Pe(),o=(0,n.Kh)({userAccount:"",userPassword:""}),l=async e=>{try{console.log("登录请求参数：",e);const o=await _e(e);console.log("登录接口返回：",o);const r=o.data||o;0===r.code&&r.data?(t.setLoginUser(r.data),i.Ay.success("登录成功"),setTimeout((async()=>{await a.push({path:"/app/components/leader-dashboard",replace:!0}),console.log("登录成功，跳转到首页")}),500)):i.Ay.error(r.message||"登录失败：账号或密码错误")}catch(o){i.Ay.error(o.message||"登录异常，请稍后重试"),console.error("登录请求失败：",o)}},s=e=>{console.log("表单验证失败：",e)};return(e,a)=>{const t=(0,r.g2)("a-input"),n=(0,r.g2)("a-form-item"),i=(0,r.g2)("a-input-password"),c=(0,r.g2)("a-button"),u=(0,r.g2)("a-form");return(0,r.uX)(),(0,r.CE)("div",W,[(0,r.Lk)("div",z,[a[3]||(a[3]=(0,r.Lk)("h2",{class:"title"},"用户登录",-1)),(0,r.bF)(u,{model:o,"label-align":"left",name:"basic","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",onFinish:l,onFinishFailed:s},{default:(0,r.k6)((()=>[(0,r.bF)(n,{label:"账号",name:"userAccount",rules:[{required:!0,message:"请输入账号！"}]},{default:(0,r.k6)((()=>[(0,r.bF)(t,{value:o.userAccount,"onUpdate:value":a[0]||(a[0]=e=>o.userAccount=e),placeholder:"请输入账号"},null,8,["value"])])),_:1}),(0,r.bF)(n,{label:"密码",name:"userPassword",rules:[{required:!0,message:"请输入密码!"},{min:8,message:"密码不能小于8位"}]},{default:(0,r.k6)((()=>[(0,r.bF)(i,{value:o.userPassword,"onUpdate:value":a[1]||(a[1]=e=>o.userPassword=e),placeholder:"请输入密码"},null,8,["value"])])),_:1}),(0,r.bF)(n,{"wrapper-col":{offset:4,span:20}},{default:(0,r.k6)((()=>[(0,r.bF)(c,{type:"primary","html-type":"submit",block:""},{default:(0,r.k6)((()=>a[2]||(a[2]=[(0,r.eW)("登录")]))),_:1})])),_:1})])),_:1},8,["model"])])])}}});const X=(0,f.A)(q,[["__scopeId","data-v-c4f3cc64"]]);var Y=X;const D={id:"userRegisterPage"};var j=(0,r.pM)({__name:"UserRegisterPage",setup(e){const a=(0,c.rd)(),t=Pe(),o=(0,n.Kh)({userAccount:"",userPassword:"",checkPassword:""}),l=async e=>{if(o.userPassword!==o.checkPassword)return void i.Ay.error("二次输入的密码不一致");const r=await Le(e);0===r.data.code&&r.data.data?(await t.fetchLoginUser(),i.Ay.success("注册成功"),a.push({path:"/user/login",replace:!0})):i.Ay.error("注册失败"+r.data.description)},s=e=>{console.log("Failed:",e)};return(e,a)=>{const t=(0,r.g2)("a-input"),n=(0,r.g2)("a-form-item"),i=(0,r.g2)("a-input-password"),c=(0,r.g2)("a-button"),u=(0,r.g2)("a-form");return(0,r.uX)(),(0,r.CE)("div",D,[a[4]||(a[4]=(0,r.Lk)("h2",{class:"title"},"用户注册",-1)),(0,r.bF)(u,{style:{"max-width":"480px",margin:"0 auto"},model:o,"label-align":"left",name:"basic","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",onFinish:l,onFinishFailed:s},{default:(0,r.k6)((()=>[(0,r.bF)(n,{label:"账号",name:"userAccount",rules:[{required:!0,message:"请输入账号！"}]},{default:(0,r.k6)((()=>[(0,r.bF)(t,{value:o.userAccount,"onUpdate:value":a[0]||(a[0]=e=>o.userAccount=e)},null,8,["value"])])),_:1}),(0,r.bF)(n,{label:"密码",name:"userPassword",rules:[{required:!0,message:"请输入密码!"},{min:8,message:"密码不能小于8位"}]},{default:(0,r.k6)((()=>[(0,r.bF)(i,{value:o.userPassword,"onUpdate:value":a[1]||(a[1]=e=>o.userPassword=e),placeholder:"请输入密码"},null,8,["value"])])),_:1}),(0,r.bF)(n,{label:"确认密码",name:"checkPassword",rules:[{required:!0,message:"请输入确认密码!"},{min:8,message:"确认密码不能小于8位"}]},{default:(0,r.k6)((()=>[(0,r.bF)(i,{value:o.checkPassword,"onUpdate:value":a[2]||(a[2]=e=>o.checkPassword=e),placeholder:"请输入确认密码"},null,8,["value"])])),_:1}),(0,r.bF)(n,{"wrapper-col":{offset:4,span:20}},{default:(0,r.k6)((()=>[(0,r.bF)(c,{type:"primary","html-type":"submit"},{default:(0,r.k6)((()=>a[3]||(a[3]=[(0,r.eW)("注册")]))),_:1})])),_:1})])),_:1},8,["model"])])}}});const N=j;var $=N,B=t.p+"img/hb.66d72f90.png",H=t(1229),J=t(1043);const G={class:"layout-container"},Z={class:"sidebar"},Q={class:"logout-btn"},V={class:"main-content"};var ee=(0,r.pM)({__name:"BasicLayout",setup(e){const a=(0,c.rd)(),t=Pe(),o=(0,n.KR)([{key:"/app/components/leader-dashboard",label:"数据看板",title:"数据看板",icon:()=>(0,r.h)(H.A)},{key:"/app/home",label:"报表",title:"报表",icon:()=>(0,r.h)(J.A)}]),l=({key:e})=>{a.push(e)},s=(0,n.KR)(["/app/home"]);a.afterEach((e=>{s.value=[e.path]}));const u=async()=>{try{await Ae({}),"function"===typeof t.clearLoginUser?t.clearLoginUser():t.loginUser={userName:"未登录"},localStorage.removeItem("loginUser"),localStorage.removeItem("token"),d(),i.Ay.success("退出成功"),a.replace({path:"/user/login"})}catch(e){console.error("退出登录接口调用失败：",e),"function"===typeof t.clearLoginUser?t.clearLoginUser():t.loginUser={userName:"未登录"},localStorage.removeItem("loginUser"),localStorage.removeItem("token"),d(),i.Ay.success("已退出登录"),a.replace({path:"/user/login"})}},d=()=>{const e=document.cookie.split(";");for(let a=0;a<e.length;a++){const t=e[a],o=t.indexOf("="),r=o>-1?t.substr(0,o).trim():t.trim();document.cookie=`${r}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/; domain=${window.location.hostname}`}};return(e,a)=>{const t=(0,r.g2)("a-menu"),n=(0,r.g2)("a-button"),i=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",G,[(0,r.Lk)("aside",Z,[a[2]||(a[2]=(0,r.Lk)("div",{class:"sidebar-header"},[(0,r.Lk)("img",{class:"logo",src:B,alt:"logo"})],-1)),(0,r.bF)(t,{selectedKeys:s.value,"onUpdate:selectedKeys":a[0]||(a[0]=e=>s.value=e),mode:"vertical",items:o.value,onClick:l,class:"sidebar-menu"},null,8,["selectedKeys","items"]),(0,r.Lk)("div",Q,[(0,r.bF)(n,{type:"text",onClick:u},{default:(0,r.k6)((()=>a[1]||(a[1]=[(0,r.eW)("退出登录")]))),_:1})])]),(0,r.Lk)("main",V,[(0,r.bF)(i)])])}}});const ae=(0,f.A)(ee,[["__scopeId","data-v-286c4c8a"]]);var te=ae,oe=(t(8992),t(3949),t(1454),t(2805)),re=t(9041);const le={id:"leaderDashboardPage"},ne={class:"production-cards"},se={class:"chart-section pie-chart-section"},ie={style:{width:"100%",height:"300px"}},ce={class:"chart-section line-charts-section"},ue={style:{width:"100%",height:"300px"}},de={style:{width:"100%",height:"300px"}},pe={style:{width:"100%",height:"300px"}},ge={class:"refresh-btn-group"};var me=(0,r.pM)({__name:"LeaderDashboard",setup(e){const a=(0,n.KR)(!1),t=(0,n.Kh)({yesterday:0,week:0,month:0,year:0}),o=(0,n.KR)(null),l=(0,n.KR)(null),s=(0,n.KR)(null),c=(0,n.KR)(null);let u=null,d=null,p=null,g=null,m=null;const v=(0,n.KR)([]),h=(0,n.KR)({xAxis:[],series:[]}),f=(0,n.KR)({xAxis:[],series:[]}),y=(0,n.KR)({xAxis:[],series:[]}),b=async(e,a)=>{const t={"/api/production/core":async()=>({code:200,msg:"success",data:{yesterday:Math.floor(2e3*Math.random()+12e3),week:Math.floor(5e3*Math.random()+85e3),month:Math.floor(1e4*Math.random()+38e4),year:Math.floor(5e4*Math.random()+42e5)}}),"/api/production/pie":async()=>({code:200,msg:"success",data:[{name:"车间A",value:Math.floor(1e4*Math.random()+18e4)},{name:"车间B",value:Math.floor(8e3*Math.random()+12e4)},{name:"车间C",value:Math.floor(5e3*Math.random()+7e4)},{name:"外协加工",value:Math.floor(3e3*Math.random()+4e4)}]}),"/api/production/dayLine":async()=>({code:200,msg:"success",data:{xAxis:["01日","02日","03日","04日","05日","06日","07日"],series:[{name:"日产量",data:[11800,12580,13200,11950,12800,12100,12580].map((e=>e+Math.floor(500*Math.random()-250)))}]}}),"/api/production/weekLine":async()=>({code:200,msg:"success",data:{xAxis:["第1周","第2周","第3周","第4周","第5周"],series:[{name:"周产量",data:[78500,82600,85800,89650,87200].map((e=>e+Math.floor(1e3*Math.random()-500)))}]}}),"/api/production/monthLine":async()=>({code:200,msg:"success",data:{xAxis:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],series:[{name:"月产量",data:[325e3,348e3,362e3,375e3,38e4,385600,392e3,398e3,405e3,41e4,415e3,42e4].map((e=>e+Math.floor(2e3*Math.random()-1e3)))}]}})};if(t[e])return await new Promise((e=>setTimeout(e,500))),t[e]();throw new Error(`未找到模拟接口: ${e}`)},k=async e=>{const a=await b("/api/production/core",e);if(200!==a.code)throw new Error(a.msg);return a.data},w=async e=>{const a=await b("/api/production/pie",e);if(200!==a.code)throw new Error(a.msg);return a.data},x=async e=>{const a=await b("/api/production/dayLine",e);if(200!==a.code)throw new Error(a.msg);return a.data},L=async e=>{const a=await b("/api/production/weekLine",e);if(200!==a.code)throw new Error(a.msg);return a.data},_=async e=>{const a=await b("/api/production/monthLine",e);if(200!==a.code)throw new Error(a.msg);return a.data},A=()=>{if(o.value&&l.value&&s.value&&c.value)if(0!==v.value.length&&0!==h.value.series.length)try{u&&u.dispose(),u=re.Ts(o.value),u.setOption({color:["#003399","#00AEEF","#0066CC","#66B2FF"],tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} 件 ({d}%)"},legend:{orient:"horizontal",bottom:0,textStyle:{color:"#333"}},series:[{name:"产量占比",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,label:{show:!1},emphasis:{label:{show:!0,fontSize:16,fontWeight:600}},labelLine:{show:!1},data:v.value}]}),d&&d.dispose(),d=re.Ts(l.value),d.setOption({color:["#003399"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:h.value.xAxis,axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"}},yAxis:{type:"value",name:"产量(件)",nameTextStyle:{color:"#003399"},axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"},splitLine:{lineStyle:{color:"#e8f4fc"}}},series:h.value.series.map((e=>({name:e.name,type:"line",smooth:!0,data:e.data,lineStyle:{width:2},itemStyle:{color:"#00AEEF",borderColor:"#003399",borderWidth:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(0, 174, 239, 0.2)"},{offset:1,color:"rgba(0, 174, 239, 0.05)"}]}}})))}),p&&p.dispose(),p=re.Ts(s.value),p.setOption({color:["#003399"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:f.value.xAxis,axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"}},yAxis:{type:"value",name:"产量(件)",nameTextStyle:{color:"#003399"},axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"},splitLine:{lineStyle:{color:"#e8f4fc"}}},series:f.value.series.map((e=>({name:e.name,type:"line",smooth:!0,data:e.data,lineStyle:{width:2},itemStyle:{color:"#00AEEF",borderColor:"#003399",borderWidth:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(0, 174, 239, 0.2)"},{offset:1,color:"rgba(0, 174, 239, 0.05)"}]}}})))}),g&&g.dispose(),g=re.Ts(c.value),g.setOption({color:["#003399"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:y.value.xAxis,axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"}},yAxis:{type:"value",name:"产量(件)",nameTextStyle:{color:"#003399"},axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"},splitLine:{lineStyle:{color:"#e8f4fc"}}},series:y.value.series.map((e=>({name:e.name,type:"line",smooth:!0,data:e.data,lineStyle:{width:2},itemStyle:{color:"#00AEEF",borderColor:"#003399",borderWidth:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(0, 174, 239, 0.2)"},{offset:1,color:"rgba(0, 174, 239, 0.05)"}]}}})))}),console.log("【图表初始化】所有图表初始化成功")}catch(e){console.error("【图表初始化】失败:",e)}else console.warn("【图表初始化】数据未就绪，跳过本次初始化");else console.warn("【图表初始化】DOM容器未就绪，跳过本次初始化")},F=()=>{u?.resize(),d?.resize(),p?.resize(),g?.resize()},S=async()=>{try{a.value=!0;const e={},[o,l,n,s,c]=await Promise.all([k(e),w(e),x(e),L(e),_(e)]);Object.assign(t,o),v.value=l,h.value=n,f.value=s,y.value=c,await(0,r.dY)(),setTimeout((()=>{A()}),300),i.Ay.success("全部数据刷新成功")}catch(e){console.error("获取数据失败：",e),i.Ay.error("数据加载失败，请稍后重试")}finally{a.value=!1}};return(0,r.sV)((async()=>{await S(),window.addEventListener("resize",F),m=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(console.log("【DOM监听】图表容器可见，触发初始化"),A())}))}),{threshold:.1}),o.value&&m.observe(o.value),l.value&&m.observe(l.value),s.value&&m.observe(s.value),c.value&&m.observe(c.value)})),(0,r.$u)((async()=>{await(0,r.dY)(),A()})),(0,r.hi)((()=>{u?.dispose(),d?.dispose(),p?.dispose(),g?.dispose(),window.removeEventListener("resize",F),m&&(m.disconnect(),m=null)})),(0,r.wB)([v,h,f,y],(async()=>{await(0,r.dY)(),setTimeout((()=>{A()}),100)}),{deep:!0}),(e,i)=>{const u=(0,r.g2)("a-statistic"),d=(0,r.g2)("a-card"),p=(0,r.g2)("a-button");return(0,r.uX)(),(0,r.CE)("div",le,[i[1]||(i[1]=(0,r.Lk)("div",{class:"page-header"},[(0,r.Lk)("h2",{class:"page-title"},"数据看板"),(0,r.Lk)("p",{class:"page-desc"},"展示核心指标及趋势数据")],-1)),(0,r.Lk)("div",ne,[(0,r.bF)(d,{class:"production-card",loading:a.value,hoverable:""},{default:(0,r.k6)((()=>[(0,r.bF)(u,{title:"昨日产量",value:t.yesterday,precision:0,suffix:"件",class:"stat-item"},{prefix:(0,r.k6)((()=>[(0,r.bF)((0,n.R1)(oe.A),{class:"stat-icon"})])),_:1},8,["value"])])),_:1},8,["loading"]),(0,r.bF)(d,{class:"production-card",loading:a.value,hoverable:""},{default:(0,r.k6)((()=>[(0,r.bF)(u,{title:"当周产量",value:t.week,precision:0,suffix:"件",class:"stat-item"},{prefix:(0,r.k6)((()=>[(0,r.bF)((0,n.R1)(oe.A),{class:"stat-icon"})])),_:1},8,["value"])])),_:1},8,["loading"]),(0,r.bF)(d,{class:"production-card",loading:a.value,hoverable:""},{default:(0,r.k6)((()=>[(0,r.bF)(u,{title:"当月产量",value:t.month,precision:0,suffix:"件",class:"stat-item"},{prefix:(0,r.k6)((()=>[(0,r.bF)((0,n.R1)(oe.A),{class:"stat-icon"})])),_:1},8,["value"])])),_:1},8,["loading"]),(0,r.bF)(d,{class:"production-card",loading:a.value,hoverable:""},{default:(0,r.k6)((()=>[(0,r.bF)(u,{title:"今年产量",value:t.year,precision:0,suffix:"件",class:"stat-item"},{prefix:(0,r.k6)((()=>[(0,r.bF)((0,n.R1)(oe.A),{class:"stat-icon"})])),_:1},8,["value"])])),_:1},8,["loading"])]),(0,r.Lk)("div",se,[(0,r.bF)(d,{class:"chart-card",loading:a.value,title:"产量占比分析","title-style":{color:"#003399",fontWeight:600}},{default:(0,r.k6)((()=>[(0,r.Lk)("div",ie,[(0,r.Lk)("div",{ref_key:"pieChartRef",ref:o,class:"chart-container"},null,512)])])),_:1},8,["loading"])]),(0,r.Lk)("div",ce,[(0,r.bF)(d,{class:"chart-card line-chart-card",loading:a.value,title:"日产量趋势","title-style":{color:"#003399",fontWeight:600}},{default:(0,r.k6)((()=>[(0,r.Lk)("div",ue,[(0,r.Lk)("div",{ref_key:"dayLineChartRef",ref:l,class:"chart-container"},null,512)])])),_:1},8,["loading"]),(0,r.bF)(d,{class:"chart-card line-chart-card",loading:a.value,title:"周产量趋势","title-style":{color:"#003399",fontWeight:600}},{default:(0,r.k6)((()=>[(0,r.Lk)("div",de,[(0,r.Lk)("div",{ref_key:"weekLineChartRef",ref:s,class:"chart-container"},null,512)])])),_:1},8,["loading"]),(0,r.bF)(d,{class:"chart-card line-chart-card",loading:a.value,title:"月产量趋势","title-style":{color:"#003399",fontWeight:600}},{default:(0,r.k6)((()=>[(0,r.Lk)("div",pe,[(0,r.Lk)("div",{ref_key:"monthLineChartRef",ref:c,class:"chart-container"},null,512)])])),_:1},8,["loading"])]),(0,r.Lk)("div",ge,[(0,r.bF)(p,{type:"primary",onClick:S,loading:a.value,icon:"reload"},{default:(0,r.k6)((()=>i[0]||(i[0]=[(0,r.eW)(" 刷新全部数据 ")]))),_:1},8,["loading"])])])}}});const ve=(0,f.A)(me,[["__scopeId","data-v-01c0ac10"]]);var he=ve;const fe=[{path:"/",redirect:"/user/login"},{path:"/user/login",name:"userLogin",component:Y,meta:{requiresAuth:!1}},{path:"/user/register",name:"userRegister",component:$,meta:{requiresAuth:!1}},{path:"/app",component:te,meta:{requiresAuth:!0},children:[{path:"home",name:"homePage",component:U},{path:"admin/userManage",name:"adminUserManage",component:O},{path:"components/leader-dashboard",name:"LeaderDashboard",component:he,meta:{title:"领导仓数据看板"}}]},{path:"/:pathMatch(.*)*",redirect:"/user/login"}],ye=(0,c.aE)({history:(0,c.LA)("/"),routes:fe});ye.beforeEach(((e,a,t)=>{const o=Pe(),r=localStorage.getItem("loginUser");if(r)try{const e=JSON.parse(r);e.id&&!o.loginUser.id&&o.setLoginUser(e)}catch(n){console.error("本地存储用户信息异常：",n),localStorage.removeItem("loginUser"),o.setLoginUser({id:""})}const l=!!o.loginUser.id;e.meta.requiresAuth?l?t():(i.Ay.warning("请先登录后再访问"),t({path:"/user/login",query:{redirect:encodeURIComponent(e.fullPath)}})):!l||"/user/login"!==e.path&&"/user/register"!==e.path?t():t("/app/home")}));var be=ye;let ke=!1;const we=s.A.create({baseURL:window.location.origin,timeout:1e4,withCredentials:!0});we.interceptors.request.use((function(e){return e.headers["Content-Type"]||(e.headers["Content-Type"]="application/json;charset=UTF-8"),e}),(function(e){return i.Ay.error("请求配置异常，请检查参数或网络设置"),console.error("请求拦截器错误：",e),Promise.reject(e)})),we.interceptors.response.use((function(e){if("blob"===e.config.responseType){let a="导出文件.xlsx";if(e.headers["content-disposition"]||e.headers["Content-Disposition"])try{const t=e.headers["content-disposition"]||e.headers["Content-Disposition"];a=decodeURI(t.split("filename=")[1]),a=a.replace(/"/g,"")}catch(t){a="导出文件.xlsx"}return e.fileBlobData=e.data,e.fileDownloadName=a,e}const{data:a}=e;if(console.log("响应数据：",a),40100===a.code){const a=e.request.responseURL.includes("user/current"),t=be.currentRoute.value.path.includes("/user/login");if(!a&&!t&&!ke){ke=!0,i.Ay.warning("登录状态已过期，请重新登录");const e=Pe();e.setLoginUser({id:""}),localStorage.removeItem("loginUser"),be.push({path:"/user/login",query:{redirect:encodeURIComponent(be.currentRoute.value.fullPath)}}).finally((()=>{ke=!1}))}}return a.code&&0!==a.code&&40100!==a.code&&i.Ay.error(a.message||`请求失败（错误码：${a.code}）`),e}),(function(e){if(e.response){const a=e.response.status;if(401!==a||ke)401!==a&&i.Ay.error(`请求失败（HTTP状态码：${a}）`);else{const e=be.currentRoute.value.path.includes("/user/login");if(!e){ke=!0,i.Ay.warning("登录状态已过期，请重新登录");const e=Pe();e.setLoginUser({id:""}),localStorage.removeItem("loginUser"),be.push({path:"/user/login",query:{redirect:encodeURIComponent(be.currentRoute.value.fullPath)}}).finally((()=>{ke=!1}))}}}else e.request?i.Ay.error("网络异常，请检查网络连接"):i.Ay.error("请求配置失败："+e.message);return console.error("响应拦截器错误：",e),Promise.reject(e)}));var xe=we;const Le=async e=>xe.request({url:"api/user/register",method:"POST",data:e}),_e=async e=>xe.request({url:"api/user/login",method:"POST",data:e}),Ae=async e=>xe.request({url:"api/user/logout",method:"POST",data:e}),Fe=async()=>xe.request({url:"api/user/current",method:"GET"}),Se=async e=>xe.request({url:"api/user/search",method:"GET",params:{userName:e}}),Ue=async e=>xe.request({url:"api/user/delete",method:"POST",data:e,headers:{"Content-Type":"application/json"}}),Ce=async e=>xe.request({url:"/api/ReportRecord/GetReportByPage",method:"GET",params:e}),Re=async(e,a)=>xe.request({url:"api/Report/ExportExcel",method:"GET",params:{id:e,tabKey:a},responseType:"blob",timeout:6e4}),Ie=async e=>xe.request({url:"/api/File/ZipFileBigTest",method:"POST",data:e,responseType:"blob",timeout:12e4}),Pe=(0,l.nY)("loginUser",(()=>{const e=(0,n.KR)(localStorage.getItem("loginUser")?JSON.parse(localStorage.getItem("loginUser")):{userName:"未登录"});async function a(){try{const a=await Fe();0===a.data.code&&a.data.data&&(console.log("接口获取用户信息：",a.data.data),e.value=a.data.data,localStorage.setItem("loginUser",JSON.stringify(a.data.data)),a.data.data.token&&localStorage.setItem("token",a.data.data.token))}catch(a){console.error("获取当前用户信息失败：",a)}}function t(a){e.value=a,localStorage.setItem("loginUser",JSON.stringify(a)),a.token&&localStorage.setItem("token",a.token)}function o(){e.value={userName:"未登录"},localStorage.removeItem("loginUser"),localStorage.removeItem("token")}function r(){const a=localStorage.getItem("loginUser");a&&(e.value=JSON.parse(a))}return{loginUser:e,setLoginUser:t,fetchLoginUser:a,clearLoginUser:o,restoreLoginUser:r}})),Ee={id:"app"};var Me=(0,r.pM)({__name:"App",setup(e){const a=Pe();return a.fetchLoginUser(),(e,a)=>{const t=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",Ee,[(0,r.bF)(t)])}}});const Te=Me;var Ke=Te,Oe=t(5296);t(4529);const We=(0,o.Ef)(Ke);We.use((0,l.Ey)()),We.use(be),We.use(Oe.Ay),window.addEventListener("unhandledrejection",(e=>{e.preventDefault();const a=e.reason;401!==a?.response?.status&&40100!==a?.response?.data?.code?(i.Ay.error("系统异常，请稍后重试"),console.error("全局捕获未处理的Promise错误：",a)):console.info("401错误已在axios拦截器中处理，无需重复提示",a)})),We.use(Oe.Ay),We.config.globalProperties.$message=i.Ay;const ze=Pe();ze.restoreLoginUser(),We.mount("#app")}},a={};function t(o){var r=a[o];if(void 0!==r)return r.exports;var l=a[o]={exports:{}};return e[o].call(l.exports,l,l.exports,t),l.exports}t.m=e,function(){var e=[];t.O=function(a,o,r,l){if(!o){var n=1/0;for(u=0;u<e.length;u++){o=e[u][0],r=e[u][1],l=e[u][2];for(var s=!0,i=0;i<o.length;i++)(!1&l||n>=l)&&Object.keys(t.O).every((function(e){return t.O[e](o[i])}))?o.splice(i--,1):(s=!1,l<n&&(n=l));if(s){e.splice(u--,1);var c=r();void 0!==c&&(a=c)}}return a}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[o,r,l]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var o in a)t.o(a,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:a[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){t.p="/"}(),function(){var e={524:0};t.O.j=function(a){return 0===e[a]};var a=function(a,o){var r,l,n=o[0],s=o[1],i=o[2],c=0;if(n.some((function(a){return 0!==e[a]}))){for(r in s)t.o(s,r)&&(t.m[r]=s[r]);if(i)var u=i(t)}for(a&&a(o);c<n.length;c++)l=n[c],t.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return t.O(u)},o=self["webpackChunkuser_center_frontend_vue"]=self["webpackChunkuser_center_frontend_vue"]||[];o.forEach(a.bind(null,0)),o.push=a.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(4015)}));o=t.O(o)})();
//# sourceMappingURL=app.b5a3c782.js.map