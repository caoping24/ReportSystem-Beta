(function(){"use strict";var e={7251:function(e,a,t){var o=t(5130),r=t(6768),n=t(657),l=t(144),s=(t(4114),t(4373)),u=t(7694),i=t(1387),c=(t(4603),t(7566),t(8721),t(4232)),d=t(1576),p=t.n(d),g=t(4079),m=t(2076);const v=(0,r.pM)({name:"ReportTable"});var f=(0,r.pM)({...v,props:{tabKey:{},columns:{},dataSource:{},paginationConfig:{},paginationParams:{}},emits:["download"],setup(e,{emit:a}){const t=a,o=e,n=e=>{t("download",o.tabKey,e)};return(e,a)=>{const t=(0,r.g2)("a-button"),o=(0,r.g2)("a-table");return(0,r.uX)(),(0,r.Wv)(o,{columns:e.columns,"data-source":e.dataSource,bordered:"",pagination:e.paginationConfig,"row-key":e=>e.id},{bodyCell:(0,r.k6)((({column:o,record:s,index:u})=>["index"===o.key?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)((0,c.v_)((e.paginationParams.pageIndex-1)*e.paginationParams.pageSize+u+1),1)],64)):"createTime"===o.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,r.eW)((0,c.v_)((0,l.R1)(p())(s.createdtime).format("YYYY-MM-DD HH:mm:ss")),1)],64)):"action"===o.key?((0,r.uX)(),(0,r.Wv)(t,{key:2,onClick:e=>n(s.id)},{default:(0,r.k6)((()=>a[0]||(a[0]=[(0,r.eW)("下载")]))),_:2},1032,["onClick"])):(0,r.Q3)("",!0)])),_:1},8,["columns","data-source","pagination","row-key"])}}});const y=f;var h=y,b=t(6011),k=t(8392);t(4514);const w={id:"userManagePage"},_={class:"batch-download-container"},U={class:"date-range-group"},x={class:"batch-tips"};var F=(0,r.pM)({__name:"HomePage",setup(e){p().locale("zh-cn");const a=[{key:"1",tab:"日报表"},{key:"2",tab:"周报表"},{key:"3",tab:"月报表"},{key:"4",tab:"年报表"}],t=[{title:"序号",key:"index",width:80,align:"center"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"操作",key:"action",width:120,align:"center"}],o=(0,l.KR)("1"),n=(0,l.KR)(!1),s=(0,l.Kh)({pageIndex:1,pageSize:10,total:0}),i=(0,l.Kh)({1:{list:[]},2:{list:[]},3:{list:[]},4:{list:[]}}),d=(0,l.KR)(""),v=(0,l.KR)(null),f=(0,l.KR)(null),y=(0,l.KR)(!1),F={3:"month"},A={3:"YYYY年MM月"},I=(0,r.EW)((()=>({current:s.pageIndex,pageSize:s.pageSize,total:s.total,pageSizeOptions:["10","20","50","100"],showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`,onChange:(e,t)=>{s.pageIndex=e,s.pageSize=t,a.map((e=>e.key)).includes(o.value)&&W(o.value)},onShowSizeChange:(e,t)=>{s.pageIndex=1,s.pageSize=t,a.map((e=>e.key)).includes(o.value)&&W(o.value)}}))),C=(0,r.EW)((()=>d.value&&F[d.value]||"date")),P=(0,r.EW)((()=>d.value&&A[d.value]||"YYYY年MM月DD日")),S=e=>e?.isAfter(p()().endOf("day"))||!1,R=()=>d.value?v.value&&f.value?!v.value.isAfter(f.value)||(u.Ay.warning("开始时间不能晚于结束时间"),!1):(u.Ay.warning("请选择开始时间和结束时间"),!1):(u.Ay.warning("请选择报表类型"),!1),L=(e,a,t)=>{const o={xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",zip:"application/zip"},r=new Blob([e.data],{type:o[t]}),n=e.headers?.["content-disposition"];let l=a;if(n){const e=n.match(/filename\*=UTF-8''([^;]+)/i);if(e?.[1])l=decodeURIComponent(e[1]);else{const e=n.match(/filename=([^;]+)/i);e?.[1]&&(l=decodeURIComponent(e[1].replace(/['"]/g,"")))}}const s=window.URL.createObjectURL(r),i=document.createElement("a");i.href=s,i.download=l,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(s),u.Ay.success(("xlsx"===t?"报表":"ZIP包")+"下载成功")},E=async(e,a)=>{if(!a)return u.Ay.warning("ID 不能为空");try{const t=await me(Number(a),Number(e));L(t,"报表.xlsx","xlsx")}catch(t){console.error("报表下载失败：",t),u.Ay.error("下载失败：网络异常或接口错误")}},T=async()=>{if(!R())return;const e={type:Number(d.value),startTime:v.value.format(P.value),endTime:f.value.format(P.value)};try{y.value=!0;const a=await ve(e);L(a,`批量报表_${p()().format("YYYYMMDDHHmmss")}.zip`,"zip")}catch(a){console.error("批量下载ZIP失败：",a),u.Ay.error("批量下载失败：网络异常或接口错误")}finally{y.value=!1}},K=e=>{o.value=e,"5"!==e&&(s.pageIndex=1,W(e))},M=()=>{v.value=null,f.value=null},O=()=>{d.value="",v.value=null,f.value=null},W=async e=>{if(!n.value)try{n.value=!0;const a=await ge({pageIndex:s.pageIndex,pageSize:s.pageSize,type:Number(e)});a.data?(i[e].list=a.data.data||[],s.total=a.data.totalCount||0):u.Ay.error(`获取${e}号表格数据失败`)}catch(a){console.error(`获取${e}号表格数据异常：`,a),u.Ay.error(`获取${e}号表格数据失败：网络异常`)}finally{n.value=!1}};return W("1"),(e,o)=>{const n=(0,r.g2)("a-tab-pane"),u=(0,r.g2)("a-select-option"),p=(0,r.g2)("a-select"),F=(0,r.g2)("a-form-item"),A=(0,r.g2)("a-date-picker"),R=(0,r.g2)("a-button"),L=(0,r.g2)("a-form"),W=(0,r.g2)("a-tabs");return(0,r.uX)(),(0,r.CE)("div",w,[(0,r.bF)(W,{"default-active-key":"1",type:"card",onChange:K},{default:(0,r.k6)((()=>[((0,r.uX)(),(0,r.CE)(r.FK,null,(0,r.pI)(a,(e=>(0,r.bF)(n,{key:e.key,tab:e.tab},{default:(0,r.k6)((()=>[(0,r.bF)(h,{"tab-key":e.key,columns:t,"data-source":i[e.key]?.list||[],"pagination-config":I.value,"pagination-params":s,onDownload:E},null,8,["tab-key","data-source","pagination-config","pagination-params"])])),_:2},1032,["tab"]))),64)),(0,r.bF)(n,{tab:"批量下载报表",key:"5"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",_,[o[6]||(o[6]=(0,r.Lk)("div",{class:"batch-download-header"},[(0,r.Lk)("h3",{class:"batch-download-title"},"批量报表下载"),(0,r.Lk)("p",{class:"batch-download-desc"}," 根据选择的报表类型和时间范围，批量下载报表文件并打包为ZIP格式 ")],-1)),(0,r.bF)((0,l.R1)(b.Ay),{locale:(0,l.R1)(k.A)},{default:(0,r.k6)((()=>[(0,r.bF)(L,{class:"batch-download-form",layout:"vertical","label-col":{span:4},"wrapper-col":{span:20}},{default:(0,r.k6)((()=>[(0,r.bF)(F,{label:"报表类型","validate-status":d.value?"":"error",help:d.value?"":"请选择报表类型"},{default:(0,r.k6)((()=>[(0,r.bF)(p,{value:d.value,"onUpdate:value":o[0]||(o[0]=e=>d.value=e),style:{width:"100%","max-width":"300px"},placeholder:"请选择报表类型","allow-clear":"",onChange:M},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.filter((e=>"4"!==e.key)),(e=>((0,r.uX)(),(0,r.Wv)(u,{key:e.key,value:e.key},{default:(0,r.k6)((()=>[(0,r.eW)((0,c.v_)(e.tab),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1},8,["validate-status","help"]),(0,r.Lk)("div",U,[(0,r.bF)(F,{label:"开始时间","validate-status":!v.value&&d.value?"error":"",help:!v.value&&d.value?"请选择开始时间":""},{default:(0,r.k6)((()=>[(0,r.bF)(A,{value:v.value,"onUpdate:value":o[1]||(o[1]=e=>v.value=e),picker:C.value,style:{width:"100%","max-width":"300px"},placeholder:"选择开始时间",format:P.value,"allow-clear":"","disabled-date":S},null,8,["value","picker","format"])])),_:1},8,["validate-status","help"]),(0,r.bF)(F,{label:"结束时间","validate-status":!f.value&&d.value?"error":"",help:!f.value&&d.value?"请选择结束时间":""},{default:(0,r.k6)((()=>[(0,r.bF)(A,{value:f.value,"onUpdate:value":o[2]||(o[2]=e=>f.value=e),picker:C.value,style:{width:"100%","max-width":"300px"},placeholder:"选择结束时间",format:P.value,"allow-clear":"","disabled-date":S},null,8,["value","picker","format"])])),_:1},8,["validate-status","help"])]),(0,r.bF)(F,{"wrapper-col":{offset:4}},{default:(0,r.k6)((()=>[(0,r.bF)(R,{type:"primary",onClick:T,loading:y.value,class:"batch-download-btn"},{icon:(0,r.k6)((()=>[(0,r.bF)((0,l.R1)(g.A))])),default:(0,r.k6)((()=>[o[3]||(o[3]=(0,r.eW)(" 批量下载ZIP "))])),_:1},8,["loading"]),(0,r.bF)(R,{onClick:O,style:{"margin-left":"12px"}},{default:(0,r.k6)((()=>o[4]||(o[4]=[(0,r.eW)(" 重置 ")]))),_:1}),(0,r.Lk)("div",x,[(0,r.bF)((0,l.R1)(m.A),{style:{color:"#1890ff","margin-right":"4px"}}),o[5]||(o[5]=(0,r.eW)(" 提示：下载的ZIP包包含所选时间范围内的所有对应类型报表文件 "))])])),_:1})])),_:1})])),_:1},8,["locale"])])])),_:1})])),_:1})])}}}),A=t(1241);const I=(0,A.A)(F,[["__scopeId","data-v-0a50710a"]]);var C=I;const P={id:"userManagePage"},S={key:0},R={key:1},L={key:0},E={key:1},T={key:2};var K=(0,r.pM)({__name:"UserManagePage",setup(e){const a=(0,l.KR)(""),t=async()=>{i(a.value)},o=async e=>{if(!e)return;const a=await pe(e);0===a.data.code?(i(),u.Ay.success("删除成功")):u.Ay.error("删除失败")},n=[{title:"id",dataIndex:"id"},{title:"用户名",dataIndex:"userName"},{title:"账号",dataIndex:"userAccount"},{title:"头像",dataIndex:"avatarUrl"},{title:"性别",dataIndex:"gender"},{title:"创建时间",dataIndex:"createTime"},{title:"用户角色",dataIndex:"userRole"},{title:"操作",key:"action"}],s=(0,l.KR)([]),i=async(e="")=>{const a=await de(e);a.data.data?s.value=a.data.data:u.Ay.error("获取数据失败")};return i(),(e,u)=>{const i=(0,r.g2)("a-input-search"),d=(0,r.g2)("a-image"),g=(0,r.g2)("a-tag"),m=(0,r.g2)("a-button"),v=(0,r.g2)("a-table");return(0,r.uX)(),(0,r.CE)("div",P,[(0,r.bF)(i,{style:{"max-width":"320px","margin-bottom":"20px"},value:a.value,"onUpdate:value":u[0]||(u[0]=e=>a.value=e),placeholder:"输入用户名搜索","enter-button":"搜索",size:"large",onSearch:t},null,8,["value"]),(0,r.bF)(v,{columns:n,"data-source":s.value},{bodyCell:(0,r.k6)((({column:e,record:a})=>["avatarUrl"===e.dataIndex?((0,r.uX)(),(0,r.Wv)(d,{key:0,src:a.avatarUrl,width:120},null,8,["src"])):"userRole"===e.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[1===a.role?((0,r.uX)(),(0,r.CE)("div",S,[(0,r.bF)(g,{color:"green"},{default:(0,r.k6)((()=>u[1]||(u[1]=[(0,r.eW)("管理员")]))),_:1})])):((0,r.uX)(),(0,r.CE)("div",R,[(0,r.bF)(g,{color:"blue"},{default:(0,r.k6)((()=>u[2]||(u[2]=[(0,r.eW)("普通用户")]))),_:1})]))],64)):"gender"===e.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:2},[0===a.gender?((0,r.uX)(),(0,r.CE)("div",L,[(0,r.bF)(g,{color:"blue"},{default:(0,r.k6)((()=>u[3]||(u[3]=[(0,r.eW)("男")]))),_:1})])):1===a.gender?((0,r.uX)(),(0,r.CE)("div",E,[(0,r.bF)(g,{color:"green"},{default:(0,r.k6)((()=>u[4]||(u[4]=[(0,r.eW)("女")]))),_:1})])):((0,r.uX)(),(0,r.CE)("div",T,[(0,r.bF)(g,{color:"gray"},{default:(0,r.k6)((()=>u[5]||(u[5]=[(0,r.eW)("未知")]))),_:1})]))],64)):(0,r.Q3)("",!0),"createTime"===e.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:3},[(0,r.eW)((0,c.v_)((0,l.R1)(p())(a.createTime).format("YYYY-MM-DD HH:mm:ss")),1)],64)):"action"===e.key?((0,r.uX)(),(0,r.Wv)(m,{key:4,danger:"",onClick:e=>o(a.id)},{default:(0,r.k6)((()=>u[6]||(u[6]=[(0,r.eW)("删除")]))),_:2},1032,["onClick"])):(0,r.Q3)("",!0)])),_:1},8,["data-source"])])}}});const M=K;var O=M;const W={id:"userLoginPage"},q={class:"login-card"};var X=(0,r.pM)({__name:"UserLoginPage",setup(e){const a=(0,i.rd)(),t=fe(),o=(0,l.Kh)({userAccount:"",userPassword:""}),n=async e=>{try{console.log("登录请求参数：",e);const o=await ue(e);console.log("登录接口返回：",o);const r=o.data||o;0===r.code&&r.data?(t.setLoginUser(r.data),u.Ay.success("登录成功"),setTimeout((async()=>{await a.push({path:"/app/home",replace:!0}),console.log("登录成功，跳转到首页")}),500)):u.Ay.error(r.message||"登录失败：账号或密码错误")}catch(o){u.Ay.error(o.message||"登录异常，请稍后重试"),console.error("登录请求失败：",o)}},s=e=>{console.log("表单验证失败：",e)};return(e,a)=>{const t=(0,r.g2)("a-input"),l=(0,r.g2)("a-form-item"),u=(0,r.g2)("a-input-password"),i=(0,r.g2)("a-button"),c=(0,r.g2)("a-form");return(0,r.uX)(),(0,r.CE)("div",W,[(0,r.Lk)("div",q,[a[3]||(a[3]=(0,r.Lk)("h2",{class:"title"},"用户登录",-1)),(0,r.bF)(c,{model:o,"label-align":"left",name:"basic","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",onFinish:n,onFinishFailed:s},{default:(0,r.k6)((()=>[(0,r.bF)(l,{label:"账号",name:"userAccount",rules:[{required:!0,message:"请输入账号！"}]},{default:(0,r.k6)((()=>[(0,r.bF)(t,{value:o.userAccount,"onUpdate:value":a[0]||(a[0]=e=>o.userAccount=e),placeholder:"请输入账号"},null,8,["value"])])),_:1}),(0,r.bF)(l,{label:"密码",name:"userPassword",rules:[{required:!0,message:"请输入密码!"},{min:8,message:"密码不能小于8位"}]},{default:(0,r.k6)((()=>[(0,r.bF)(u,{value:o.userPassword,"onUpdate:value":a[1]||(a[1]=e=>o.userPassword=e),placeholder:"请输入密码"},null,8,["value"])])),_:1}),(0,r.bF)(l,{"wrapper-col":{offset:4,span:20}},{default:(0,r.k6)((()=>[(0,r.bF)(i,{type:"primary","html-type":"submit",block:""},{default:(0,r.k6)((()=>a[2]||(a[2]=[(0,r.eW)("登录")]))),_:1})])),_:1})])),_:1},8,["model"])])])}}});const Y=(0,A.A)(X,[["__scopeId","data-v-d06a875c"]]);var z=Y;const N={id:"userRegisterPage"};var j=(0,r.pM)({__name:"UserRegisterPage",setup(e){const a=(0,i.rd)(),t=fe(),o=(0,l.Kh)({userAccount:"",userPassword:"",checkPassword:""}),n=async e=>{if(o.userPassword!==o.checkPassword)return void u.Ay.error("二次输入的密码不一致");const r=await se(e);0===r.data.code&&r.data.data?(await t.fetchLoginUser(),u.Ay.success("注册成功"),a.push({path:"/user/login",replace:!0})):u.Ay.error("注册失败"+r.data.description)},s=e=>{console.log("Failed:",e)};return(e,a)=>{const t=(0,r.g2)("a-input"),l=(0,r.g2)("a-form-item"),u=(0,r.g2)("a-input-password"),i=(0,r.g2)("a-button"),c=(0,r.g2)("a-form");return(0,r.uX)(),(0,r.CE)("div",N,[a[4]||(a[4]=(0,r.Lk)("h2",{class:"title"},"用户注册",-1)),(0,r.bF)(c,{style:{"max-width":"480px",margin:"0 auto"},model:o,"label-align":"left",name:"basic","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",onFinish:n,onFinishFailed:s},{default:(0,r.k6)((()=>[(0,r.bF)(l,{label:"账号",name:"userAccount",rules:[{required:!0,message:"请输入账号！"}]},{default:(0,r.k6)((()=>[(0,r.bF)(t,{value:o.userAccount,"onUpdate:value":a[0]||(a[0]=e=>o.userAccount=e)},null,8,["value"])])),_:1}),(0,r.bF)(l,{label:"密码",name:"userPassword",rules:[{required:!0,message:"请输入密码!"},{min:8,message:"密码不能小于8位"}]},{default:(0,r.k6)((()=>[(0,r.bF)(u,{value:o.userPassword,"onUpdate:value":a[1]||(a[1]=e=>o.userPassword=e),placeholder:"请输入密码"},null,8,["value"])])),_:1}),(0,r.bF)(l,{label:"确认密码",name:"checkPassword",rules:[{required:!0,message:"请输入确认密码!"},{min:8,message:"确认密码不能小于8位"}]},{default:(0,r.k6)((()=>[(0,r.bF)(u,{value:o.checkPassword,"onUpdate:value":a[2]||(a[2]=e=>o.checkPassword=e),placeholder:"请输入确认密码"},null,8,["value"])])),_:1}),(0,r.bF)(l,{"wrapper-col":{offset:4,span:20}},{default:(0,r.k6)((()=>[(0,r.bF)(i,{type:"primary","html-type":"submit"},{default:(0,r.k6)((()=>a[3]||(a[3]=[(0,r.eW)("注册")]))),_:1})])),_:1})])),_:1},8,["model"])])}}});const D=j;var $=D,H=t.p+"img/logo.003b08be.png";const G={class:"layout-container"},J={class:"sidebar"},Z={class:"logout-btn"},B={class:"main-content"};var Q=(0,r.pM)({__name:"BasicLayout",setup(e){const a=(0,i.rd)(),t=fe(),o=(0,l.KR)([{key:"/app/home",label:"主页",title:"主页"}]),n=({key:e})=>{a.push(e)},s=(0,l.KR)(["/app/home"]);a.afterEach((e=>{s.value=[e.path]}));const c=async()=>{try{await ie({}),"function"===typeof t.clearLoginUser?t.clearLoginUser():t.loginUser={userName:"未登录"},localStorage.removeItem("loginUser"),localStorage.removeItem("token"),d(),u.Ay.success("退出成功"),a.replace({path:"/user/login"})}catch(e){console.error("退出登录接口调用失败：",e),"function"===typeof t.clearLoginUser?t.clearLoginUser():t.loginUser={userName:"未登录"},localStorage.removeItem("loginUser"),localStorage.removeItem("token"),d(),u.Ay.success("已退出登录"),a.replace({path:"/user/login"})}},d=()=>{const e=document.cookie.split(";");for(let a=0;a<e.length;a++){const t=e[a],o=t.indexOf("="),r=o>-1?t.substr(0,o).trim():t.trim();document.cookie=`${r}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/; domain=${window.location.hostname}`}};return(e,a)=>{const t=(0,r.g2)("a-menu"),l=(0,r.g2)("a-button"),u=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",G,[(0,r.Lk)("aside",J,[a[2]||(a[2]=(0,r.Lk)("div",{class:"sidebar-header"},[(0,r.Lk)("img",{class:"logo",src:H,alt:"logo"}),(0,r.Lk)("div",{class:"title"},"用户中心")],-1)),(0,r.bF)(t,{selectedKeys:s.value,"onUpdate:selectedKeys":a[0]||(a[0]=e=>s.value=e),mode:"vertical",items:o.value,onClick:n,class:"sidebar-menu"},null,8,["selectedKeys","items"]),(0,r.Lk)("div",Z,[(0,r.bF)(l,{type:"text",onClick:c},{default:(0,r.k6)((()=>a[1]||(a[1]=[(0,r.eW)("退出登录")]))),_:1})])]),(0,r.Lk)("main",B,[(0,r.bF)(u)])])}}});const V=(0,A.A)(Q,[["__scopeId","data-v-4121be22"]]);var ee=V;const ae=[{path:"/",redirect:"/user/login"},{path:"/user/login",name:"userLogin",component:z,meta:{requiresAuth:!1}},{path:"/user/register",name:"userRegister",component:$,meta:{requiresAuth:!1}},{path:"/app",component:ee,meta:{requiresAuth:!0},children:[{path:"home",name:"homePage",component:C},{path:"admin/userManage",name:"adminUserManage",component:O}]},{path:"/:pathMatch(.*)*",redirect:"/user/login"}],te=(0,i.aE)({history:(0,i.LA)("/"),routes:ae});te.beforeEach(((e,a,t)=>{const o=fe(),r=localStorage.getItem("loginUser");if(r)try{const e=JSON.parse(r);e.id&&!o.loginUser.id&&o.setLoginUser(e)}catch(l){console.error("本地存储用户信息异常：",l),localStorage.removeItem("loginUser"),o.setLoginUser({id:""})}const n=!!o.loginUser.id;e.meta.requiresAuth?n?t():(u.Ay.warning("请先登录后再访问"),t({path:"/user/login",query:{redirect:encodeURIComponent(e.fullPath)}})):!n||"/user/login"!==e.path&&"/user/register"!==e.path?t():t("/app/home")}));var oe=te;let re=!1;const ne=s.A.create({baseURL:"http://localhost:5260",timeout:1e4,withCredentials:!0});ne.interceptors.request.use((function(e){return e.headers["Content-Type"]||(e.headers["Content-Type"]="application/json;charset=UTF-8"),e}),(function(e){return u.Ay.error("请求配置异常，请检查参数或网络设置"),console.error("请求拦截器错误：",e),Promise.reject(e)})),ne.interceptors.response.use((function(e){if("blob"===e.config.responseType){let a="导出文件.xlsx";if(e.headers["content-disposition"]||e.headers["Content-Disposition"])try{const t=e.headers["content-disposition"]||e.headers["Content-Disposition"];a=decodeURI(t.split("filename=")[1]),a=a.replace(/"/g,"")}catch(t){a="导出文件.xlsx"}return e.fileBlobData=e.data,e.fileDownloadName=a,e}const{data:a}=e;if(console.log("响应数据：",a),40100===a.code){const a=e.request.responseURL.includes("user/current"),t=oe.currentRoute.value.path.includes("/user/login");if(!a&&!t&&!re){re=!0,u.Ay.warning("登录状态已过期，请重新登录");const e=fe();e.setLoginUser({id:""}),localStorage.removeItem("loginUser"),oe.push({path:"/user/login",query:{redirect:encodeURIComponent(oe.currentRoute.value.fullPath)}}).finally((()=>{re=!1}))}}return a.code&&0!==a.code&&40100!==a.code&&u.Ay.error(a.message||`请求失败（错误码：${a.code}）`),e}),(function(e){if(e.response){const a=e.response.status;if(401!==a||re)401!==a&&u.Ay.error(`请求失败（HTTP状态码：${a}）`);else{const e=oe.currentRoute.value.path.includes("/user/login");if(!e){re=!0,u.Ay.warning("登录状态已过期，请重新登录");const e=fe();e.setLoginUser({id:""}),localStorage.removeItem("loginUser"),oe.push({path:"/user/login",query:{redirect:encodeURIComponent(oe.currentRoute.value.fullPath)}}).finally((()=>{re=!1}))}}}else e.request?u.Ay.error("网络异常，请检查网络连接"):u.Ay.error("请求配置失败："+e.message);return console.error("响应拦截器错误：",e),Promise.reject(e)}));var le=ne;const se=async e=>le.request({url:"api/user/register",method:"POST",data:e}),ue=async e=>le.request({url:"api/user/login",method:"POST",data:e}),ie=async e=>le.request({url:"api/user/logout",method:"POST",data:e}),ce=async()=>le.request({url:"api/user/current",method:"GET"}),de=async e=>le.request({url:"api/user/search",method:"GET",params:{userName:e}}),pe=async e=>le.request({url:"api/user/delete",method:"POST",data:e,headers:{"Content-Type":"application/json"}}),ge=async e=>le.request({url:"/api/ReportRecord/GetReportByPage",method:"GET",params:e}),me=async(e,a)=>le.request({url:"api/Report/ExportExcel",method:"GET",params:{id:e,tabKey:a},responseType:"blob",timeout:6e4}),ve=async e=>le.request({url:"api/Report/BatchExportZip",method:"GET",params:e,responseType:"blob",timeout:12e4}),fe=(0,n.nY)("loginUser",(()=>{const e=(0,l.KR)(localStorage.getItem("loginUser")?JSON.parse(localStorage.getItem("loginUser")):{userName:"未登录"});async function a(){try{const a=await ce();0===a.data.code&&a.data.data&&(console.log("接口获取用户信息：",a.data.data),e.value=a.data.data,localStorage.setItem("loginUser",JSON.stringify(a.data.data)),a.data.data.token&&localStorage.setItem("token",a.data.data.token))}catch(a){console.error("获取当前用户信息失败：",a)}}function t(a){e.value=a,localStorage.setItem("loginUser",JSON.stringify(a)),a.token&&localStorage.setItem("token",a.token)}function o(){e.value={userName:"未登录"},localStorage.removeItem("loginUser"),localStorage.removeItem("token")}function r(){const a=localStorage.getItem("loginUser");a&&(e.value=JSON.parse(a))}return{loginUser:e,setLoginUser:t,fetchLoginUser:a,clearLoginUser:o,restoreLoginUser:r}})),ye={id:"app"};var he=(0,r.pM)({__name:"App",setup(e){const a=fe();return a.fetchLoginUser(),(e,a)=>{const t=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",ye,[(0,r.bF)(t)])}}});const be=he;var ke=be,we=t(6487);t(4529);const _e=(0,o.Ef)(ke);_e.use((0,n.Ey)()),_e.use(oe),_e.use(we.Ay),window.addEventListener("unhandledrejection",(e=>{e.preventDefault();const a=e.reason;401!==a?.response?.status&&40100!==a?.response?.data?.code?(u.Ay.error("系统异常，请稍后重试"),console.error("全局捕获未处理的Promise错误：",a)):console.info("401错误已在axios拦截器中处理，无需重复提示",a)})),_e.use(we.Ay),_e.config.globalProperties.$message=u.Ay;const Ue=fe();Ue.restoreLoginUser(),_e.mount("#app")}},a={};function t(o){var r=a[o];if(void 0!==r)return r.exports;var n=a[o]={exports:{}};return e[o].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(a,o,r,n){if(!o){var l=1/0;for(c=0;c<e.length;c++){o=e[c][0],r=e[c][1],n=e[c][2];for(var s=!0,u=0;u<o.length;u++)(!1&n||l>=n)&&Object.keys(t.O).every((function(e){return t.O[e](o[u])}))?o.splice(u--,1):(s=!1,n<l&&(l=n));if(s){e.splice(c--,1);var i=r();void 0!==i&&(a=i)}}return a}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[o,r,n]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var o in a)t.o(a,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:a[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){t.p="/"}(),function(){var e={524:0};t.O.j=function(a){return 0===e[a]};var a=function(a,o){var r,n,l=o[0],s=o[1],u=o[2],i=0;if(l.some((function(a){return 0!==e[a]}))){for(r in s)t.o(s,r)&&(t.m[r]=s[r]);if(u)var c=u(t)}for(a&&a(o);i<l.length;i++)n=l[i],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(c)},o=self["webpackChunkuser_center_frontend_vue"]=self["webpackChunkuser_center_frontend_vue"]||[];o.forEach(a.bind(null,0)),o.push=a.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(7251)}));o=t.O(o)})();
//# sourceMappingURL=app.fa1490fa.js.map